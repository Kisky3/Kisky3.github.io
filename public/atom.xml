<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xiang Yu&#39;s Blog</title>
  
  <subtitle>Hello World, Hello Programming!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://kisky3.github.io/"/>
  <updated>2020-07-12T10:36:10.155Z</updated>
  <id>https://kisky3.github.io/</id>
  
  <author>
    <name>Xiang Yu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Make My First Pr Animation Video</title>
    <link href="https://kisky3.github.io/2020/04/17/MakeMyFirstPrAnimationVideo/"/>
    <id>https://kisky3.github.io/2020/04/17/MakeMyFirstPrAnimationVideo/</id>
    <published>2020-04-17T10:01:37.000Z</published>
    <updated>2020-07-12T10:36:10.155Z</updated>
    
    <content type="html"><![CDATA[<p>使用Adobe Pr制作我的第一个动画</p><a id="more"></a><p>最近尝试使用Adobe XD和 Pr制作了一个简易的产品开发说明动画。</p><p>制作出来的效果像下面这样：<br><br></p><div class="video-container"><iframe src="https://kisky3.github.io/2020/04/17/MakeMyFirstPrAnimationVideo/video.mp4" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe></div><br><h1 id="参考视频："><a href="#参考视频：" class="headerlink" title="参考视频："></a>参考视频：</h1><ul><li><a href="https://www.bilibili.com/video/BV15b411q7zX?from=search&seid=12054323442701734548" target="_blank" rel="noopener">Adobe XD 25步从零到动效输出</a></li><li><a href="https://www.bilibili.com/video/BV1h7411U7BX" target="_blank" rel="noopener">10分钟快速上手premiere剪辑！</a></li><li><a href="https://www.bilibili.com/video/BV1nW411V7Vi" target="_blank" rel="noopener">（干货）2秒学会PR音频淡入淡出/PR如何让音频淡入淡出</a></li><li><a href="https://www.bilibili.com/video/BV1vJ411d7vy" target="_blank" rel="noopener">【Pr模板】1450个免费Pr模板，承包你一辈子的剪辑！</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用Adobe Pr制作我的第一个动画&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Adobe Pr" scheme="https://kisky3.github.io/tags/Adobe-Pr/"/>
    
      <category term="Animation Video" scheme="https://kisky3.github.io/tags/Animation-Video/"/>
    
  </entry>
  
  <entry>
    <title>Setting Image Psth by :src=&quot;require(Var)&quot;</title>
    <link href="https://kisky3.github.io/2020/04/12/ImagePathOfVue/"/>
    <id>https://kisky3.github.io/2020/04/12/ImagePathOfVue/</id>
    <published>2020-04-12T09:42:16.000Z</published>
    <updated>2020-07-12T09:58:47.064Z</updated>
    
    <content type="html"><![CDATA[<p>使用:src=”require(Var)”指定图像路径</p><a id="more"></a><p>最近在写vue时被卡了一下。</p><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><p>Vue的component里想引用图像文件。<br>首先把图像文件放在了assets里，并如下引用文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src=<span class="string">"require('@/assets/hoge.jpg')"</span></span><br></pre></td></tr></table></figure><p>但是奇怪的是并取不到文件，并且显示<code>Cannot find module &#39;@/assets/hoge.jpg</code>的错误。</p><ul><li>hoge.vue</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template lang=<span class="string">"pug"</span>&gt;</span><br><span class="line">  v-container(grid-list-lg fluid pa<span class="number">-0</span>)</span><br><span class="line">    v-layout(row wrap)</span><br><span class="line">      template(v-<span class="keyword">for</span>=<span class="string">"(pr, index) in prContents"</span>)</span><br><span class="line">        v-flex(xs12 md4 :key=<span class="string">"index"</span>)</span><br><span class="line">          v-card</span><br><span class="line">            v-img(:src=<span class="string">"require(pr.image)"</span> height=<span class="string">"300"</span>)</span><br><span class="line">            v-container(fill-height fluid pa<span class="number">-2</span>)</span><br><span class="line">              v-layout(fill-height)</span><br><span class="line">                v-flex(xs12 align-end flexbox)</span><br><span class="line">                  span(<span class="class"><span class="keyword">class</span></span>=<span class="string">"headline white--text"</span> v-text=<span class="string">"pr.title"</span>)</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: 'HomeConcept',</span></span><br><span class="line"><span class="regexp">  data () &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      prContent: [</span></span><br><span class="line"><span class="regexp">        &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル1',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: '@/assets/hoge1.jpg'</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">       &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル2',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: '@/assets/hoge2.jpg'</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">       &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル3',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: '@/assets/hoge3.jpg'</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">      ]</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped  lang=<span class="string">"stylus"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure><hr><h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>require内，如果单纯使用文字列的话，@是无法识别的，所以require()要在data对象里实行。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    prContents: [</span><br><span class="line">      &#123;</span><br><span class="line">        title: <span class="string">"タイトル1"</span>,</span><br><span class="line">        contents: <span class="string">"コンテンツ"</span>,</span><br><span class="line">        image: <span class="built_in">require</span>(<span class="string">"@/images/hoge.jpg"</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改后的hoge.vue</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template lang=<span class="string">"pug"</span>&gt;</span><br><span class="line">  v-container(grid-list-lg fluid pa<span class="number">-0</span>)</span><br><span class="line">    v-layout(row wrap)</span><br><span class="line">      template(v-<span class="keyword">for</span>=<span class="string">"(pr, index) in prContents"</span>)</span><br><span class="line">        v-flex(xs12 md4 :key=<span class="string">"index"</span>)</span><br><span class="line">          v-card</span><br><span class="line">            v-img(:src=<span class="string">"pr.image"</span> height=<span class="string">"300"</span>)</span><br><span class="line">            v-container(fill-height fluid pa<span class="number">-2</span>)</span><br><span class="line">              v-layout(fill-height)</span><br><span class="line">                v-flex(xs12 align-end flexbox)</span><br><span class="line">                  span(<span class="class"><span class="keyword">class</span></span>=<span class="string">"headline white--text"</span> v-text=<span class="string">"pr.title"</span>)</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: 'HomeConcept',</span></span><br><span class="line"><span class="regexp">  data () &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      prContents: [</span></span><br><span class="line"><span class="regexp">        &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル1',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: require('@/assets/hoge1.jpg')</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">        &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル2',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: require('@/assets/images/3pr-medical.jpg')</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">        &#123;</span></span><br><span class="line"><span class="regexp">          title: 'タイトル3',</span></span><br><span class="line"><span class="regexp">          contents: 'コンテンツ',</span></span><br><span class="line"><span class="regexp">          image: require('@/assets/images/3pr-compassionate.jpg')</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">      ]</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped  lang=<span class="string">"stylus"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure><p>如果只是一般的修改参数来引用图像的情况下，写成下面这样就可以了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;img</span><br><span class="line">  :src=<span class="string">"require('@/assets/img/' + domainName + '.png')"</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span></span>=<span class="string">"c-logo-takaku"</span></span><br><span class="line">  alt=<span class="string">""</span></span><br><span class="line">/&gt;</span><br><span class="line">...</span><br><span class="line">data(): Data &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      domainName: <span class="string">'xxxx'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用:src=”require(Var)”指定图像路径&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Vue" scheme="https://kisky3.github.io/tags/Vue/"/>
    
      <category term=":src" scheme="https://kisky3.github.io/tags/src/"/>
    
      <category term="image path" scheme="https://kisky3.github.io/tags/image-path/"/>
    
  </entry>
  
  <entry>
    <title>Delete Amazon Cloud Front Cache(Invalidation)</title>
    <link href="https://kisky3.github.io/2020/03/18/DeleteAmazonCloudFrontCache/"/>
    <id>https://kisky3.github.io/2020/03/18/DeleteAmazonCloudFrontCache/</id>
    <published>2020-03-18T09:07:39.000Z</published>
    <updated>2020-07-12T09:30:44.470Z</updated>
    
    <content type="html"><![CDATA[<p>删除Amazon Cloud Front的缓存(Invalidation)</p><a id="more"></a><h1 id="什么是-Amazon-CloudFront"><a href="#什么是-Amazon-CloudFront" class="headerlink" title="什么是 Amazon CloudFront"></a>什么是 Amazon CloudFront</h1><p>Amazon CloudFront 是一种全球内容分发网络服务，可以安全地以低延迟和高传输速度向浏览者分发数据、视频、应用程序和 API。CloudFront 与 AWS 与多种 AWS 产品集成。</p><hr><h1 id="Amazon-CloudFront是怎么运作的"><a href="#Amazon-CloudFront是怎么运作的" class="headerlink" title="Amazon CloudFront是怎么运作的"></a>Amazon CloudFront是怎么运作的</h1><p>举例说明，当客户端发起对 <a href="http://www.customer.com" target="_blank" rel="noopener">www.customer.com</a> 的访问时，首先需要 DNS 系统解析出该域名对应的主机 IP，通过本地 ISP DNS 递归查询到 customer.com 的 DNS 域名服务器并了解到该域名是指向了 xxx.cloudfront.net ，进一步解析 xxx.cloudfront.net ，CloudFront 的 DNS 域名服务器会根据请求来源的 IP 等信息，返回适合当前该客户端访问的边缘节点的主机 IP 如 1.1.1.1，最终该客户端向 1.1.1.1 发出请求。如果该边缘节点已经缓存了该客户端请求的内容（图片、视频等静态文件），则直接返回给客户端，如果未缓存，则首先回源取回该内容，并存储在边缘节点，以便下次客户端对该内容请求时可以直接返回该内容。<br><br><br><img src="./1.png" style="width:500px"></p><hr><h1 id="什么是Invalidation"><a href="#什么是Invalidation" class="headerlink" title="什么是Invalidation"></a>什么是Invalidation</h1><p>Invalidation是用于删除CloudFront的边缘节点主机的缓存功能。</p><hr><h1 id="如何删除缓存"><a href="#如何删除缓存" class="headerlink" title="如何删除缓存"></a>如何删除缓存</h1><p>1.打开该CloudFront的控制台。<br><img src="./2.png" style="width:500px"></p><p>2.选择Invalidations，并点击「Create Invalidation」按钮。<br><img src="./3.png" style="width:500px"></p><p>3.指定你所想删除的对象的缓存路径。<br>能够使用wildcard，所以如果你想删除所有的缓存的时候可以使用wildcard，像下面这样输入<code>/*</code>就好,然后点击「Invalidate」按钮。<br><img src="./4.png" style="width:500px"></p><p>点击后就可以发现界面上被追加了一行，Status这一列的状态变成了<code>In Progress</code>。<br><img src="./5.png" style="width:500px"></p><p>如果缓存被删除完成，Status就会变成<code>Completed</code>.<br><img src="./6.png" style="width:500px"></p><hr><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Invalidation删除功能是指删除你所指定的对象的缓存，并不影响缓存以后的保存。<br>Invalidation指定后，所显示的行是删除历史记录，这个历史记录是不能被删除的。<br>这个删除并不会改变该对象的缓存保存的设定，当缓存重新生成之后，还是会被重新保存的。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;删除Amazon Cloud Front的缓存(Invalidation)&lt;/p&gt;
    
    </summary>
    
      <category term="System Setting" scheme="https://kisky3.github.io/categories/System-Setting/"/>
    
    
      <category term="Docker" scheme="https://kisky3.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Create Json By GAS and Deploy to S3</title>
    <link href="https://kisky3.github.io/2020/03/12/createJsonByGAS/"/>
    <id>https://kisky3.github.io/2020/03/12/createJsonByGAS/</id>
    <published>2020-03-12T08:13:07.000Z</published>
    <updated>2020-07-12T09:01:22.730Z</updated>
    
    <content type="html"><![CDATA[<p>用GAS造json数据并自动发布到S3上</p><a id="more"></a><p>最近在开发中需要造一堆相似的阶层似的json数据。<br>实在不想手动写，所以研究了一下如何用已经存在的文本文件来造出所需要的json数据，并能够自动deploy到S3上保存起来。</p><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>首先需要在S3上生成上传所需要的user,policy和保存数据用的bucket，<br>这能保证你在GAS中上传的时候能够使用改user，并且该user拥有上传json数据的权限和连接到你保存数据用的bucket.</p><h4 id="1-user和policy的生成："><a href="#1-user和policy的生成：" class="headerlink" title="1. user和policy的生成："></a>1. user和policy的生成：</h4><p>参照之前的文章<a href="https://kisky3.github.io/2020/02/10/UseServerlessFrameworkToCreateRESTAPI/">IAM用户的生成</a><br>在这里给user添加的policy要稍微修改一下，生成一个只能上传的policy<br>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">    &quot;Statement&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br><span class="line">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br><span class="line">            &quot;Action&quot;: &quot;s3:PutObject&quot;,</span><br><span class="line">            &quot;Resource&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-bucket的生成："><a href="#2-bucket的生成：" class="headerlink" title="2. bucket的生成："></a>2. bucket的生成：</h4><p>bucket就直接在S3新建就好了，但是在access权限上，最好是设置成只能取得这个bucket数据的权限。<br>例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">    &quot;Id&quot;: &quot;Policy1454907251774&quot;,</span><br><span class="line">    &quot;Statement&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Sid&quot;: &quot;Stmt1454907246553&quot;,</span><br><span class="line">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br><span class="line">            &quot;Principal&quot;: &quot;*&quot;,</span><br><span class="line">            &quot;Action&quot;: &quot;s3:GetObject&quot;, // 只能取得数据的Action</span><br><span class="line">            &quot;Resource&quot;: &quot;arn:aws:s3:::your_bucket_name/*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>并在Bucket Property的地方选择并如下图般设置Static website hosting,并保存<br><img src="./1.png" style="width:400px;margin:40px 0"></p><hr><h3 id="GAS的生成"><a href="#GAS的生成" class="headerlink" title="GAS的生成"></a>GAS的生成</h3><p>在准备工作做好之后就可以开始生成json数据的工作了。<br>首先整理出你所需要的文字版数据。<br><img src="./2.png" style="width:400px;margin:40px 0"></p><p>然后利用GAS的API来根据你文字版数据的sheet和内容生成你所需要的json。<br>写法基本和普通的js差不多，取得数据后编辑成你所需要的形式，<br>然后利用你刚刚生成的S3的user和bucket情报来进行数据的自动上传。</p><p>在这里GAS的内容就不说明了，大概在方法里都写了注释。<br>生成的是一个比较复杂的阶层式的json，写的比较粗糙。(sorry)</p><p>GAS例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* domainによってjsonを生成してS3上にUPする ***********************************************************/</span></span><br><span class="line"><span class="comment">// 個別のjsonを生成してS3上にUPする</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateAndUploadJson</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> domain = <span class="string">"xxxxxxxx"</span></span><br><span class="line">  createCategoryData(domain)</span><br><span class="line">  UploadJson(domain)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全てのjsonを一気に生成してUPする(重いので、こげる可能性がある)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateAndUploadAll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> domain = [<span class="string">"audio-takakuureru"</span>, <span class="string">"beauty-takakuureru"</span>, <span class="string">"bicycle-takakuureru"</span>, <span class="string">"brand-takakuureru"</span>, <span class="string">"camera-takakuureru"</span>, <span class="string">"delivery-kaitori"</span>, <span class="string">"figure-takakuureru"</span>, <span class="string">"fishing-takakuureru"</span>, <span class="string">"g-takakuureru"</span>, <span class="string">"gakki-takakuureru"</span>, <span class="string">"guitar-kaitori"</span>, <span class="string">"gun-takakuureru"</span>, <span class="string">"kaden-takakuureru"</span>, <span class="string">"kagu-takakuureru"</span>, <span class="string">"kenki-takakuureru"</span>, <span class="string">"kougu-takakuureru"</span>, <span class="string">"navi-takakuureru"</span>, <span class="string">"noukigu-takakuureru"</span>, <span class="string">"pc-takakuureru"</span>, <span class="string">"sax-takakuureru"</span>, <span class="string">"sports-takakuureru"</span>, <span class="string">"syuttyou-kaitori"</span>, <span class="string">"tokei-takakuureru"</span>, <span class="string">"train-takakuureru"</span>, <span class="string">"tv-takakuureru"</span>]　</span><br><span class="line">  domain.forEach(<span class="function"><span class="params">json_domain</span> =&gt;</span> &#123;</span><br><span class="line">    createCategoryData(json_domain)</span><br><span class="line">    UploadJson(json_domain)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* S3上Upload用 ***********************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UploadJson</span>(<span class="params">domain</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> accessKey = <span class="string">'xxxxxxxxxx'</span>;</span><br><span class="line">  <span class="keyword">var</span> secretKey = <span class="string">"xxxxxxxxxx"</span></span><br><span class="line">  <span class="keyword">var</span> bucketName = <span class="string">"xxxxxxxxx"</span></span><br><span class="line">  <span class="keyword">var</span> spreadsheetId = <span class="string">'xxxxxxxxxxxx'</span></span><br><span class="line">  <span class="keyword">var</span> sheetName = domain;</span><br><span class="line">  <span class="keyword">const</span> ss = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">  <span class="keyword">var</span> sheet = ss.getSheetByName(sheetName);</span><br><span class="line">  <span class="comment">// 生成されたシートからデータを取得</span></span><br><span class="line">  <span class="keyword">var</span> data = <span class="built_in">String</span>(sheet.getRange(<span class="string">'A:A'</span>).getValues());</span><br><span class="line">  <span class="comment">// もし文字列の最後「,」が存在する場合削除する</span></span><br><span class="line">  <span class="keyword">while</span> (data.charAt(data.length - <span class="number">1</span>) == <span class="string">','</span>) &#123;</span><br><span class="line">    data = data.substr(<span class="number">0</span>, data.length - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  json = Utilities.newBlob(data, <span class="string">"application/json"</span>);</span><br><span class="line">  <span class="keyword">var</span> s3 = S3.getInstance(accessKey, secretKey);</span><br><span class="line">  <span class="keyword">var</span> response = s3.putObject(bucketName, sheetName + <span class="string">'.json'</span>, json, &#123;</span><br><span class="line">    logRequests: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">  Logger.log(response);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* サイト毎のメイン処理 **********************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCategoryData</span>(<span class="params">sheetName</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = SpreadsheetApp.getActive().getSheetByName(sheetName + <span class="string">'-data'</span>);</span><br><span class="line">  <span class="comment">//dataへ変換</span></span><br><span class="line">  <span class="keyword">var</span> dataArray = convSheet(sheet);</span><br><span class="line">  <span class="comment">//dataをJsonに変換し、新規シート出力</span></span><br><span class="line">  creatNewSheet(dataArray, sheetName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//data（配列）へ変換関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">convSheet</span>(<span class="params">sheet</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> categoryJson = []</span><br><span class="line">  Logger.log(sheet)</span><br><span class="line">  <span class="comment">//領域</span></span><br><span class="line">  <span class="keyword">var</span> jsonRange = sheet.getRange(<span class="number">2</span>, <span class="number">2</span>, sheet.getLastRow() - <span class="number">1</span>, sheet.getLastColumn() - <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// Logger.log('jsonRange:'+JSON.stringify(jsonRange));</span></span><br><span class="line">  <span class="keyword">var</span> jsonRowValues = jsonRange.getValues();</span><br><span class="line">  <span class="comment">// Logger.log('jsonRowValues:'+JSON.stringify(jsonRowValues));</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; jsonRowValues.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> catLvlObj = categoryJson.filter(<span class="function"><span class="params">cat0</span> =&gt;</span> cat0.title === jsonRowValues[i][<span class="number">0</span>])</span><br><span class="line">    <span class="comment">// 大カテゴリーは存在する場合、被るかどうかをチェック</span></span><br><span class="line">    <span class="keyword">if</span> (!!<span class="built_in">Object</span>.keys(catLvlObj).length) &#123;　</span><br><span class="line">      <span class="keyword">const</span> cat1LvlObj = catLvlObj[<span class="number">0</span>].options.filter(<span class="function"><span class="params">cat1</span> =&gt;</span> cat1.title === jsonRowValues[i][<span class="number">1</span>])</span><br><span class="line">      <span class="keyword">const</span> att = CreateJson(jsonRowValues[i][<span class="number">5</span>])</span><br><span class="line">      <span class="comment">// 中カテゴリーは存在する場合、被るかどうかをチェック</span></span><br><span class="line">      　　</span><br><span class="line">      <span class="keyword">if</span> (!!<span class="built_in">Object</span>.keys(cat1LvlObj).length) &#123;　　　　</span><br><span class="line">        cat1LvlObj[<span class="number">0</span>].options.push(&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">          category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">          attributes: att</span><br><span class="line">        &#125;)　　　　</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 中カテゴリーは値がない場合　追加</span></span><br><span class="line">        catLvlObj[<span class="number">0</span>].options.push(&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">4</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">1</span>],</span><br><span class="line">          options: [&#123;</span><br><span class="line">            id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">            title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">            category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">            attributes: att</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 大カテゴリーは存在しない場合新規追加</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> catNew = <span class="keyword">new</span> <span class="built_in">Object</span></span><br><span class="line">      catNew.id = jsonRowValues[i][<span class="number">3</span>]</span><br><span class="line">      catNew.title = jsonRowValues[i][<span class="number">0</span>]</span><br><span class="line">      <span class="keyword">const</span> att = CreateJson(jsonRowValues[i][<span class="number">5</span>])</span><br><span class="line">      catNew.options = [&#123;</span><br><span class="line">        id: jsonRowValues[i][<span class="number">4</span>],</span><br><span class="line">        title: jsonRowValues[i][<span class="number">1</span>],</span><br><span class="line">        options: [&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">          category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">          attributes: att</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">      categoryJson.push(catNew)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> categoryJson</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新規シート作成関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creatNewSheet</span>(<span class="params">dataArray, sheetName</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//data(配列)よりJsonへ変換</span></span><br><span class="line">  <span class="keyword">var</span> json = <span class="built_in">JSON</span>.stringify(dataArray);</span><br><span class="line">  <span class="comment">//出力</span></span><br><span class="line">  <span class="keyword">var</span> newSheetName = sheetName;</span><br><span class="line">  <span class="comment">//新規シート初期化</span></span><br><span class="line">  <span class="keyword">var</span> newSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(newSheetName);</span><br><span class="line">  <span class="comment">//存在有無確認</span></span><br><span class="line">  <span class="comment">//存在しない場合</span></span><br><span class="line">  <span class="keyword">if</span> (!newSheet) &#123;</span><br><span class="line">    <span class="comment">//シート生成</span></span><br><span class="line">    newSheet = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">    newSheet.insertSheet(newSheetName);</span><br><span class="line">    <span class="comment">//データ入力</span></span><br><span class="line">    newSheet.getRange(<span class="string">"A1"</span>).setValue(json);</span><br><span class="line">    <span class="comment">//存在する場合</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//データの書換え</span></span><br><span class="line">    newSheet.getRange(<span class="string">"A1"</span>).setValue(<span class="built_in">String</span>(json));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 追加項目リスト作成関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateJson</span>(<span class="params">cat2_id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ss = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">  <span class="keyword">const</span> fieldSheet = ss.getSheetByName(<span class="string">"抽出_format"</span>);</span><br><span class="line">  <span class="keyword">const</span> elementSheet = ss.getSheetByName(<span class="string">"m_format_element"</span>);</span><br><span class="line">  <span class="keyword">const</span> fieldData = fieldSheet.getDataRange().getValues();</span><br><span class="line">  <span class="keyword">const</span> elementData = elementSheet.getDataRange().getValues();</span><br><span class="line">  <span class="keyword">let</span> value = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt; fieldData.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> row = fieldData[i]</span><br><span class="line">    <span class="keyword">const</span> outputFlg = row[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (outputFlg === <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">let</span> inputHint = row[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">const</span> sort = row[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">const</span> categoryId = row[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">const</span> formatId = row[<span class="number">7</span>];</span><br><span class="line">    <span class="keyword">const</span> name = row[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">const</span> formatType = row[<span class="number">13</span>];</span><br><span class="line">    <span class="keyword">const</span> fieldKey = row[<span class="number">14</span>];</span><br><span class="line">    <span class="comment">// validate rule</span></span><br><span class="line">    <span class="keyword">const</span> rules = []</span><br><span class="line">    <span class="keyword">const</span> required = row[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">const</span> maxLength = row[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">if</span> (required === <span class="number">1</span>) &#123;</span><br><span class="line">      rules.push(<span class="string">"required"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (maxLength !== <span class="string">""</span>) &#123;</span><br><span class="line">      rules.push(<span class="string">`max:<span class="subst">$&#123;maxLength&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// select, radioのoptions</span></span><br><span class="line">    <span class="keyword">let</span> elements;</span><br><span class="line">    <span class="keyword">if</span> (formatType === <span class="string">"select"</span> || formatType === <span class="string">"radio"</span>) &#123;</span><br><span class="line">      elements = elementData.filter(<span class="function"><span class="params">row</span> =&gt;</span> row[<span class="number">0</span>] === formatId).map(<span class="function"><span class="params">row</span> =&gt;</span> row[<span class="number">2</span>])</span><br><span class="line">      <span class="keyword">if</span> (formatType === <span class="string">"radio"</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> radioObj = []</span><br><span class="line">        elements.map(<span class="function"><span class="params">el</span> =&gt;</span> radioObj.push(&#123;</span><br><span class="line">          label: el,</span><br><span class="line">          value: el</span><br><span class="line">        &#125;))</span><br><span class="line">        elements = radioObj</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (row[<span class="number">6</span>] === <span class="built_in">Number</span>(cat2_id)) &#123;</span><br><span class="line">      value.push(&#123;</span><br><span class="line">        <span class="string">"field_name"</span>: name,</span><br><span class="line">        <span class="string">"field_key"</span>: fieldKey,</span><br><span class="line">        <span class="string">"type"</span>: formatType,</span><br><span class="line">        <span class="string">"required"</span>: <span class="string">`<span class="subst">$&#123;required === <span class="number">1</span>&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"rules"</span>: <span class="string">`<span class="subst">$&#123;rules.length &gt; <span class="number">0</span> ? rules.join(<span class="string">"|"</span>) : <span class="string">""</span>&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"options"</span>: elements === <span class="literal">null</span> ? <span class="string">""</span> : elements,</span><br><span class="line">        <span class="string">"hint"</span>: <span class="string">`<span class="subst">$&#123;inputHint === <span class="literal">null</span> ? <span class="string">""</span> : inputHint&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"sort"</span>: sort,</span><br><span class="line">        <span class="string">"format_id"</span>: formatId</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="生成结果"><a href="#生成结果" class="headerlink" title="生成结果"></a>生成结果</h3><p>执行以上GAS的CreateAndUploadJson方法，就可以看到json数据被生成了sheet,并上传到了你指定的S3 Bucket上。<br><img src="./3.png" style="width:400px;margin:40px 0"></p><p>以上</p><hr><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://dev.classmethod.jp/articles/csv-and-json-convert-between-s3-and-spreadsheet/" target="_blank" rel="noopener">多分保存版？S3とSpreadSheet間でのCSVとJSONのデータ読み書きを簡単なサンプルで網羅してみた</a></p><p><a href="https://dev.classmethod.jp/articles/google-apps-script-gss-to-s3-json/" target="_blank" rel="noopener">Google Apps Scriptを利用してGoogleスプレッドシートのデータをS3へJSONとして保存する</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用GAS造json数据并自动发布到S3上&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="google app script" scheme="https://kisky3.github.io/tags/google-app-script/"/>
    
      <category term="json" scheme="https://kisky3.github.io/tags/json/"/>
    
      <category term="s3" scheme="https://kisky3.github.io/tags/s3/"/>
    
      <category term="deploy" scheme="https://kisky3.github.io/tags/deploy/"/>
    
  </entry>
  
  <entry>
    <title>Set Repository-specific Username/Email</title>
    <link href="https://kisky3.github.io/2020/03/08/GitRepositoryCOmmitUserName/"/>
    <id>https://kisky3.github.io/2020/03/08/GitRepositoryCOmmitUserName/</id>
    <published>2020-03-08T14:48:44.000Z</published>
    <updated>2020-07-12T08:09:56.317Z</updated>
    
    <content type="html"><![CDATA[<p>给特定的Git Repojitory设定用户名和邮箱</p><a id="more"></a><p>我们知道config是配置的意思，那么git config命令就是对git进行一些配置。<br>git里面一共有3个配置文件</p><h3 id="1-仓库级配置文件："><a href="#1-仓库级配置文件：" class="headerlink" title="1.仓库级配置文件："></a>1.仓库级配置文件：</h3><h4 id="方法1：找到该文件，直接打开："><a href="#方法1：找到该文件，直接打开：" class="headerlink" title="方法1：找到该文件，直接打开："></a>方法1：找到该文件，直接打开：</h4><p>该文件位于当前仓库下，路径.git/，文件名为config<br>这个配置中的设置只对当前所在仓库（H:\MyGit目录下的test仓库）有效</p><h4 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h4><p>通过命令查看项目配置（仓库级配置）：git config –local -l</p><hr><h3 id="2-全局级配置文件："><a href="#2-全局级配置文件：" class="headerlink" title="2.全局级配置文件："></a>2.全局级配置文件：</h3><h4 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h4><p>以win10个人的PC机为例，在用户目录下，其路径为：C:\Users\Administrator，文件名为 .gitconfig</p><h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2:"></a>方法2:</h4><p>通过命令查看全局级配置：git config –global -l</p><hr><h3 id="3-系统级配置文件："><a href="#3-系统级配置文件：" class="headerlink" title="3.系统级配置文件："></a>3.系统级配置文件：</h3><h4 id="方法1：-1"><a href="#方法1：-1" class="headerlink" title="方法1："></a>方法1：</h4><p>本地git的安装目录下，以我的git安装路径为例：F:\software\Git\mingw64\etc，文件名为：gitconfig</p><h4 id="方法2：-1"><a href="#方法2：-1" class="headerlink" title="方法2："></a>方法2：</h4><p>通过命令查看系统配置：git config –system -l</p><hr><p>对于git来说，配置文件的权重是仓库&gt;全局&gt;系统</p><h3 id="二、-用git-config命令查看配置文件"><a href="#二、-用git-config命令查看配置文件" class="headerlink" title="二、 用git config命令查看配置文件"></a>二、 用git config命令查看配置文件</h3><p>命令参数 –list, 简写 -l<br>格式：git config [–local|–global|–system] -l<br>查看仓库级的config，命令：git config –local -l<br>查看全局级的config，命令：git config –global -l<br>查看系统级的config，命令：git config –system -l<br>查看当前生效的配置，命令：git config -l，这个时候会显示最终三个配置文件计算后的配置信息</p><hr><h3 id="三、-使用git-config命令编辑配置文件"><a href="#三、-使用git-config命令编辑配置文件" class="headerlink" title="三、 使用git config命令编辑配置文件"></a>三、 使用git config命令编辑配置文件</h3><p>编辑的英文单词是什么，没错，edit</p><p>命令参数 –edit, 简写 -e</p><p>格式：git config [–local|–global|–system] -e</p><p>编辑仓库级的config，命令：git config –local -e，与–list参数不同的是，git config -e默认是编辑仓库级的配置文件。</p><p>编辑全局级的config，命令：git config –global -e</p><p>编辑系统级的config，命令：git config –system -e</p><p>注：执行这个命令的时候，git会用配置文件中设定的编辑器打开配置文件。</p><p>例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git config user.name &quot;hogehoge&quot;</span><br><span class="line">$ git config user.email hoge@gmail.com</span><br><span class="line"></span><br><span class="line">$ git config --global user.name &quot;hogehoge&quot;</span><br><span class="line">$ git config --global user.email hoge@gmail.com</span><br><span class="line"></span><br><span class="line">$ git config --local user.name &quot;hogehoge&quot;</span><br><span class="line">$ git config --local user.email hoge@gmail.com</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;给特定的Git Repojitory设定用户名和邮箱&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Git" scheme="https://kisky3.github.io/tags/Git/"/>
    
      <category term="GitConfig" scheme="https://kisky3.github.io/tags/GitConfig/"/>
    
  </entry>
  
  <entry>
    <title>Setting Vue CLI Modes and Environment Variables</title>
    <link href="https://kisky3.github.io/2020/03/03/SettingVueCLI-env/"/>
    <id>https://kisky3.github.io/2020/03/03/SettingVueCLI-env/</id>
    <published>2020-03-03T10:15:13.000Z</published>
    <updated>2020-07-12T08:09:56.413Z</updated>
    
    <content type="html"><![CDATA[<p>设置Vue CLI的模式和环境变量</p><a id="more"></a><p>基本上参照官方文档设定就好 <a href="https://cli.vuejs.org/guide/mode-and-env.html#modes" target="_blank" rel="noopener">Vue 官方文档</a></p><hr><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul><li>Vue CLI: 3.6.3</li></ul><hr><h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><p>本回创建本地local环境，开发环境，和生产环境</p><hr><h3 id="env文件的生成"><a href="#env文件的生成" class="headerlink" title=".env文件的生成"></a>.env文件的生成</h3><ul><li>.env.local</li><li>.env.development</li><li>.env.prod<br>在创建好的每个文件下写入相应的API Base URL.<br>本地环境的情况下 <code>.local</code>最好在.gitignore里添加，不要push到生产环境里。<br><code>VUE_APP_</code>这个接头词是必要的，漏掉的话build不成功的。。(之前卡在这了)</li></ul><p>例：<br>.env.local</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=&apos;local&apos;</span><br><span class="line">VUE_APP_API_BASE_URL=&apos;https://localhost:8080/api/v1/xxx&apos;</span><br></pre></td></tr></table></figure><p>.env.development</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=&apos;development&apos;</span><br><span class="line">VUE_APP_API_BASE_URL=&apos;https://development/api/v1/xxx&apos;</span><br></pre></td></tr></table></figure><p>.env.prod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NODE_ENV=&apos;production&apos;</span><br><span class="line">VUE_APP_API_BASE_URL=&apos;https://production/api/v1/xxx&apos;</span><br></pre></td></tr></table></figure><hr><h3 id="package-json的设定"><a href="#package-json的设定" class="headerlink" title="package.json的设定"></a>package.json的设定</h3><p>在package.json里的scripts里设定你的模式</p><p>例：<br>package.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;local-serve&quot;: &quot;vue-cli-service serve --mode local&quot;,</span><br><span class="line">    &quot;dev-serve&quot;: &quot;vue-cli-service serve --mode development&quot;,</span><br><span class="line">    &quot;prod-serve&quot;: &quot;vue-cli-service serve --mode production&quot;,</span><br><span class="line">    &quot;dev-build&quot;: &quot;vue-cli-service build --mode development&quot;,</span><br><span class="line">    &quot;prod-build&quot;: &quot;vue-cli-service build --mode production&quot;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><hr><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>根据你设定的package.json来运行<br>比如 yarn local-serve的时候，就会相应的获取.env.local里的环境变量。</p><p>这样你就能够根据不同的开发环境进行build,deploy了。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;设置Vue CLI的模式和环境变量&lt;/p&gt;
    
    </summary>
    
      <category term="System Setting" scheme="https://kisky3.github.io/categories/System-Setting/"/>
    
    
      <category term="setting" scheme="https://kisky3.github.io/tags/setting/"/>
    
      <category term="Vue CLI" scheme="https://kisky3.github.io/tags/Vue-CLI/"/>
    
      <category term="Environment Variables" scheme="https://kisky3.github.io/tags/Environment-Variables/"/>
    
  </entry>
  
  <entry>
    <title>Create a Anonymous Bot for Slack</title>
    <link href="https://kisky3.github.io/2020/02/28/slackanonymousbot/"/>
    <id>https://kisky3.github.io/2020/02/28/slackanonymousbot/</id>
    <published>2020-02-28T14:50:23.000Z</published>
    <updated>2020-07-12T08:09:56.703Z</updated>
    
    <content type="html"><![CDATA[<p>做一个可以在slack匿名发言的机器人</p><a id="more"></a><p>运行环境</p><ul><li>Ubuntu16.04</li><li>node.js</li></ul><p>完成后的示意图<br><img src="./1.png" style="width:400px;margin:40px 0"></p><h3 id="添加Bot"><a href="#添加Bot" class="headerlink" title="添加Bot"></a>添加Bot</h3><p>首先点击下面的link在slack里添加bot</p><p><a href="https://my.slack.com/services/new/bot" target="_blank" rel="noopener">https://my.slack.com/services/new/bot</a></p><p>这里用了<code>anonymous</code>的bot名字，也可以输入其他的，然后点击「Add bot integration」按钮。</p><img src="./2.png" style="width:500px;margin:40px 0"><p>然后记下画面上显示的 「API Token」</p><h3 id="获取频道ID"><a href="#获取频道ID" class="headerlink" title="获取频道ID"></a>获取频道ID</h3><p><a href="https://slack.com/api/conversations.list?token=刚刚记录下的API_Token" target="_blank" rel="noopener">https://slack.com/api/conversations.list?token=刚刚记录下的API_Token</a></p><p>还可以取得用户ID和非公开频道ID</p><hr><h3 id="安装Botkit"><a href="#安装Botkit" class="headerlink" title="安装Botkit"></a>安装Botkit</h3><p>安装并使用Slack官方文档上的Bot框架<a href="https://github.com/howdyai/botkit" target="_blank" rel="noopener">Botkit</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//创建路径</span><br><span class="line">$ cd ~</span><br><span class="line">$ mkdir slack_anonymous_bot </span><br><span class="line">$ cd slack_anonymous_bot</span><br><span class="line"></span><br><span class="line">//botkit clone</span><br><span class="line">$ git clone https://github.com/howdyai/botkit.git</span><br><span class="line">$ cd botkit</span><br><span class="line"></span><br><span class="line">//branch 移动</span><br><span class="line">$ git checkout origin/legacy </span><br><span class="line"></span><br><span class="line">//安装</span><br><span class="line">$ npm install</span><br><span class="line"></span><br><span class="line">//如果安装失败・・・</span><br><span class="line">$ npm audit fix</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure><p>如果生成了~/botkit/example/slack_bot.js就说明成功了</p><hr><h3 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 移动到你生成的路径</span><br><span class="line">$ cd ~</span><br><span class="line">$ cd slack_anonymous_bot/botkit/</span><br><span class="line"></span><br><span class="line">//制作anonymous_bot.js</span><br><span class="line">$ touch anonymous_bot.js</span><br></pre></td></tr></table></figure><p>在anonymous_bot.js里粘贴下面的代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">var Botkit = require(&quot;./lib/Botkit.js&quot;); // 注意path</span><br><span class="line">var os = require(&quot;os&quot;);</span><br><span class="line"></span><br><span class="line">var controller = Botkit.slackbot(&#123;</span><br><span class="line">    debug: true,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">var bot = controller.spawn(&#123;</span><br><span class="line">    token: &quot;刚刚记录下的API_TOKEN&quot;</span><br><span class="line">&#125;).startRTM();</span><br><span class="line"></span><br><span class="line">controller.on(&quot;direct_message&quot;, (bot, message) =&gt; &#123;</span><br><span class="line">    var now = new Date(); //获取时间</span><br><span class="line">    var user_name = &quot;名無しさん: &quot;+ now.getFullYear()+&quot;/&quot;+(now.getMonth()+1)+&quot;/&quot;+now.getDate()+&quot;/ &quot;+now.getHours()+&quot;:&quot;+now.getMinutes()+&quot;:&quot;+now.getSeconds();</span><br><span class="line"></span><br><span class="line">    bot.reply(message, &quot;匿名で投稿しました．&quot;);</span><br><span class="line"></span><br><span class="line">    bot.startConversation(&#123;  channel : &quot;刚刚取得的频道ID&quot; &#125;, (err, convo) =&gt; &#123;</span><br><span class="line">        var send_message = &#123;</span><br><span class="line">          type: &quot;message&quot;,</span><br><span class="line">          channel: &quot;刚刚取得的频道ID&quot;,</span><br><span class="line">          text: message.text,</span><br><span class="line">          username: user_name,</span><br><span class="line">          thread_ts: null,</span><br><span class="line">          reply_broadcast: null,</span><br><span class="line">          parse: null,</span><br><span class="line">          link_names: null,</span><br><span class="line">          attachments: null,</span><br><span class="line">          unfurl_links: null,</span><br><span class="line">          unfurl_media: null,</span><br><span class="line">          icon_url: null,</span><br><span class="line">          icon_emoji: &quot;:robot_face:&quot;,</span><br><span class="line">          as_user: true</span><br><span class="line">        &#125;</span><br><span class="line">        convo.say(send_message);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//debug环境</span><br><span class="line">$ cd ~/slack_anonymous_bot/botkit</span><br><span class="line">$ node anonymous_bot.js</span><br><span class="line"></span><br><span class="line">//通常一般环境</span><br><span class="line">$ cd ~/slack_anonymous_bot/botkit</span><br><span class="line">$ forever start slack_bot.js</span><br><span class="line">$ forever stop slack_bot.js // 停止bot</span><br></pre></td></tr></table></figure><hr><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p>如果bot运行成功了，bot前的灯会变绿色。<br><img src="./4.png" style="width:300px;margin:40px 0"></p><p>投稿时候首先会给你回信<br><img src="./5.png" style="width:300px;margin:40px 0"></p><p>然后你就可以看到匿名bot在你登陆的频道里代表你发言了<br><img src="./6.png" style="width:300px;margin:40px 0"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;做一个可以在slack匿名发言的机器人&lt;/p&gt;
    
    </summary>
    
      <category term="System Setting" scheme="https://kisky3.github.io/categories/System-Setting/"/>
    
    
      <category term="setting" scheme="https://kisky3.github.io/tags/setting/"/>
    
      <category term="slack bot" scheme="https://kisky3.github.io/tags/slack-bot/"/>
    
      <category term="slack" scheme="https://kisky3.github.io/tags/slack/"/>
    
      <category term="AnonymousBot" scheme="https://kisky3.github.io/tags/AnonymousBot/"/>
    
      <category term="BotKit" scheme="https://kisky3.github.io/tags/BotKit/"/>
    
  </entry>
  
  <entry>
    <title>Use ServerlessFramework To Create REST API</title>
    <link href="https://kisky3.github.io/2020/02/10/UseServerlessFrameworkToCreateRESTAPI/"/>
    <id>https://kisky3.github.io/2020/02/10/UseServerlessFrameworkToCreateRESTAPI/</id>
    <published>2020-02-10T12:03:52.000Z</published>
    <updated>2020-07-12T08:09:56.450Z</updated>
    
    <content type="html"><![CDATA[<p>使用serverless框架创建REST API</p><a id="more"></a><h3 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h3><ul><li>node.js (npm) v4以上..</li><li>awsアカウント</li><li>awscli</li></ul><p>使用下面的command确认环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">v4.3.2</span><br><span class="line">$ aws --version</span><br><span class="line">aws-cli/1.11.44 Python/2.7.10 Darwin/16.4.0 botocore/1.5.7</span><br></pre></td></tr></table></figure><hr><h3 id="安装Serverless-Framework"><a href="#安装Serverless-Framework" class="headerlink" title="安装Serverless Framework"></a>安装Serverless Framework</h3><p>首先从npm开始安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g serverless</span><br></pre></td></tr></table></figure><p>安装完成后进行版本确认</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">serverless -v</span><br><span class="line">Framework Core: 1.63.0</span><br><span class="line">Plugin: 3.3.0</span><br><span class="line">SDK: 2.3.0</span><br><span class="line">Components Core: 1.1.2</span><br><span class="line">Components CLI: 1.4.0</span><br></pre></td></tr></table></figure><h3 id="关于Serveless-Application的构成"><a href="#关于Serveless-Application的构成" class="headerlink" title="关于Serveless Application的构成"></a>关于Serveless Application的构成</h3><p>Serveless Application主要分为<strong>有各种方法(你所想运行的代码块)的文件</strong>和<strong>云端(AWS)设定文件</strong></p><hr><h3 id="设置AWS-Credentials"><a href="#设置AWS-Credentials" class="headerlink" title="设置AWS Credentials"></a>设置AWS Credentials</h3><p>首先要设置能使用Serveless Framework的IAM</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">To let the Serverless Framework access your AWS account, we&apos;re going to create an IAM User with Admin access, which can configure the services in your AWS account. This IAM User will have its own set of AWS Access Keys.</span><br></pre></td></tr></table></figure><img src="./1.png" style="width:600px;margin:40px 0"><p>输入适当的用户名，在「アクセス種類」的地方选择「プログラムによるアクセス」<br><img src="./2.png" style="width:600px;margin:40px 0"></p><p>在权限设置的地方选择「既存のポリシーを直接アタッチ」,然后搜索选择你所需要的ポリシー.<br>AdministratorAccess是已存在的权限最强的ポリシー。<br><img src="./3.png" style="width:600px;margin:40px 0"></p><p>你也可以自己制作你所需要的ポリシー,来限制你所能使用到的服务和权限范围。<br>比如说下面这个就是连接到S3的，并且只有读取权限的ポリシー<br><img src="./4.png" style="width:600px;margin:40px 0"></p><p>当用户生成之后你会得到一对key.<br>点击表示并下载csv文档.</p><p>之后就可以利用制作好的IAM User来设置Serverless Framework了。<br>用下面的 <code>aws configure</code>命令行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sls config credentials --provider aws --key XXXXXXXXXXXXEXAMPLE --secret XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXEXAMPLEKEY</span><br><span class="line">Serverless: Setting up AWS...</span><br><span class="line">Serverless: Saving your AWS profile in &quot;~/.aws/credentials&quot;...</span><br><span class="line">Serverless: Success! Your AWS access keys were stored under the &quot;default&quot; profile.</span><br></pre></td></tr></table></figure><p>如果已经有defualt的<code>aws configure</code>的时候，加上选项 –profile就好了。</p><h3 id="生成Service并deploy"><a href="#生成Service并deploy" class="headerlink" title="生成Service并deploy"></a>生成Service并deploy</h3><p>一行的命令行就行，这就是Serverless Framework的魅力。<br>首先生成新的service</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sls create -t aws-python -p slstest</span><br><span class="line">Serverless: Generating boilerplate...</span><br><span class="line">Serverless: Generating boilerplate in &quot;/your/folder/slstest&quot;</span><br><span class="line"> _______ __</span><br><span class="line">| _ .-----.----.--.--.-----.----| .-----.-----.-----.</span><br><span class="line">| |___| -__| _| | | -__| _| | -__|__ --|__ --|</span><br><span class="line">|____ |_____|__| \___/|_____|__| |__|_____|_____|_____|</span><br><span class="line">| | | The Serverless Application Framework</span><br><span class="line">| | serverless.com, v1.7.0</span><br><span class="line"> -------&apos;</span><br><span class="line"></span><br><span class="line">Serverless: Successfully generated boilerplate for template: &quot;aws-python&quot;</span><br><span class="line">$ ls slstest/</span><br><span class="line">handler.py serverless.yml</span><br></pre></td></tr></table></figure><p>这是用python function的template.你还可以选择其他的语言.</p><p>其中包括：</p><ul><li><p>handler.py<br>lambda function的template,里面已经定义好了测试用的hello function.</p></li><li><p>serverless.yml<br>用于记录Serverless Framework的设定<br><code>sls create</code> 命令行的选项</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sls create --help</span><br><span class="line">Plugin: Create</span><br><span class="line">create ........................ Create <span class="keyword">new</span> Serverless service</span><br><span class="line">--template / -t (required) ......... Template <span class="keyword">for</span> the service. Available templates: <span class="string">"aws-nodejs"</span>, <span class="string">"aws-python"</span>, <span class="string">"aws-java-maven"</span>, <span class="string">"aws-java-gradle"</span>, <span class="string">"aws-scala-sbt"</span>, <span class="string">"aws-csharp"</span>, <span class="string">"openwhisk-nodejs"</span> and <span class="string">"plugin"</span></span><br><span class="line">--path / -p ........................ The path where the service should be created (e.g. --path my-service)</span><br><span class="line">--name / -n ........................ Name <span class="keyword">for</span> the service. Overwrites the <span class="keyword">default</span> name <span class="keyword">of</span> the created service.</span><br></pre></td></tr></table></figure></li></ul><p>这次选择的是python,所以用aws-python.<br>另外，如果是新建的script的话要指定PATH.<br>slstest文件夹就是用于指定PATH.</p><p>如果是已经存在的话，script的文件夹内 使用<code>sls create</code>就好.</p><p>详细设定可以之后再编辑<code>serverless.yml</code>,现在首先要确认能否跑起来,<br>那么先移动到slstest文件夹并deploy.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ cd slstest/</span><br><span class="line">$ sls deploy</span><br><span class="line">Serverless: Creating Stack...</span><br><span class="line">Serverless: Checking Stack create progress...</span><br><span class="line">.....</span><br><span class="line">Serverless: Stack create finished...</span><br><span class="line">Serverless: Packaging service...</span><br><span class="line">Serverless: Uploading CloudFormation file to S3...</span><br><span class="line">Serverless: Uploading service .zip file to S3 (639 B)...</span><br><span class="line">Serverless: Updating Stack...</span><br><span class="line">Serverless: Checking Stack update progress...</span><br><span class="line">..................</span><br><span class="line">Serverless: Stack update finished...</span><br><span class="line">Service Information</span><br><span class="line">service: slstest</span><br><span class="line">stage: dev</span><br><span class="line">region: us-east-1</span><br><span class="line">api keys:</span><br><span class="line">None</span><br><span class="line">endpoints:</span><br><span class="line">None</span><br><span class="line">functions:</span><br><span class="line">slstest-dev-hello</span><br></pre></td></tr></table></figure><p>这样就deploy好了,里面自动设定好了CloudFormation,IAM,Lambda等.</p><h3 id="测试一下"><a href="#测试一下" class="headerlink" title="测试一下"></a>测试一下</h3><p>deploy之后测试一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sls invoke -f hello</span><br><span class="line">&#123;</span><br><span class="line">&quot;body&quot;: &quot;&#123;\&quot;input\&quot;: &#123;&#125;, \&quot;message\&quot;: \&quot;Go Serverless v1.0! Your function executed successfully!\&quot;&#125;&quot;,</span><br><span class="line">&quot;statusCode&quot;: 200</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试也非常简单.<code>sls invoke</code>的命令行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sls invoke --help</span><br><span class="line">Plugin: Invoke</span><br><span class="line">invoke ........................ Invoke a deployed function</span><br><span class="line">invoke local .................. Invoke function locally</span><br><span class="line">--function / -f (required) ......... The function name</span><br><span class="line">--stage / -s ....................... Stage of the service</span><br><span class="line">--region / -r ...................... Region of the service</span><br><span class="line">--path / -p ........................ Path to JSON or YAML file holding input data</span><br><span class="line">--type / -t ........................ Type of invocation</span><br><span class="line">--log / -l ......................... Trigger logging data output</span><br><span class="line">--data / -d ........................ input data</span><br></pre></td></tr></table></figure><p>刚刚的测试是什么都没有传递，要传递数据的时候加上<code>-d</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sls invoke -f hello -d <span class="string">'&#123;"key":"value"&#125;'</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"body"</span>: <span class="string">"&#123;\"input\": &#123;\"key\": \"value\"&#125;, \"message\": \"Go Serverless v1.0! Your function executed successfully!\"&#125;"</span>,</span><br><span class="line"><span class="string">"statusCode"</span>: <span class="number">200</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="编辑serveless-yml"><a href="#编辑serveless-yml" class="headerlink" title="编辑serveless.yml"></a>编辑serveless.yml</h3><p>region之类的设定都在生成的serveless.yml里进行编辑/</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># you can overwrite defaults here</span><br><span class="line"># stage: dev</span><br><span class="line">region: ap-northeast-1  # 在这里编辑</span><br></pre></td></tr></table></figure><p>保存设定并且再实行一次，顺便使用<code>-v</code>选项进行动作的确认</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">$ sls deploy -v</span><br><span class="line">Serverless: Creating Stack...</span><br><span class="line">Serverless: Checking Stack create progress...</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::S3::Bucket - ServerlessDeploymentBucket</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::S3::Bucket - ServerlessDeploymentBucket</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::S3::Bucket - ServerlessDeploymentBucket</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">Serverless: Stack create finished...</span><br><span class="line">Serverless: Packaging service...</span><br><span class="line">Serverless: Uploading CloudFormation file to S3...</span><br><span class="line">Serverless: Uploading service .zip file to S3 (<span class="number">639</span> B)...</span><br><span class="line">Serverless: Updating Stack...</span><br><span class="line">Serverless: Checking Stack update progress...</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::S3::Bucket - ServerlessDeploymentBucket</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">CloudFormation - UPDATE_IN_PROGRESS - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Role - IamRoleLambdaExecution</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Logs::LogGroup - HelloLogGroup</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Logs::LogGroup - HelloLogGroup</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Role - IamRoleLambdaExecution</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::Logs::LogGroup - HelloLogGroup</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::IAM::Role - IamRoleLambdaExecution</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Policy - IamPolicyLambdaExecution</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Policy - IamPolicyLambdaExecution</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::IAM::Policy - IamPolicyLambdaExecution</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::<span class="built_in">Function</span> - HelloLambdaFunction</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::<span class="built_in">Function</span> - HelloLambdaFunction</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::Lambda::<span class="built_in">Function</span> - HelloLambdaFunction</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Version - HelloLambdaVersionnjv8umhHX8AljD0VKQUqojKkzU2huW1AkaSample</span><br><span class="line">CloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Version - HelloLambdaVersionnjv8umhHX8AljD0VKQUqojKkzU2huW1AkaSample</span><br><span class="line">CloudFormation - CREATE_COMPLETE - AWS::Lambda::Version - HelloLambdaVersionnjv8umhHX8AljD0VKQUqojKkzU2huW1AkaSample</span><br><span class="line">CloudFormation - UPDATE_COMPLETE_CLEANUP_IN_PROGRESS - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">CloudFormation - UPDATE_COMPLETE - AWS::CloudFormation::Stack - slstest-dev</span><br><span class="line">Serverless: Stack update finished...</span><br><span class="line">Service Information</span><br><span class="line">service: slstest</span><br><span class="line">stage: dev</span><br><span class="line">region: ap-northeast<span class="number">-1</span></span><br><span class="line">api keys:</span><br><span class="line">None</span><br><span class="line">endpoints:</span><br><span class="line">None</span><br><span class="line">functions:</span><br><span class="line">slstest-dev-hello</span><br><span class="line"></span><br><span class="line">Stack Outputs</span><br><span class="line">HelloLambdaFunctionQualifiedArn: arn:aws:lambda:ap-northeast<span class="number">-1</span>:<span class="number">000000000000</span>:<span class="function"><span class="keyword">function</span>:<span class="title">slstest</span>-<span class="title">dev</span>-<span class="title">hello</span>:1</span></span><br><span class="line"><span class="function"><span class="title">ServerlessDeploymentBucketName</span>: <span class="title">slstest</span>-<span class="title">dev</span>-<span class="title">serverlessdeploymentbucket</span>-1<span class="title">s9cy3sample</span></span></span><br></pre></td></tr></table></figure><p><code>region: ap-northeast-1</code>是东京，可以看到这个已经被deploy了</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用serverless框架创建REST API&lt;/p&gt;
    
    </summary>
    
      <category term="Back-end Knowledge" scheme="https://kisky3.github.io/categories/Back-end-Knowledge/"/>
    
    
      <category term="serverlessframework" scheme="https://kisky3.github.io/tags/serverlessframework/"/>
    
      <category term="aws" scheme="https://kisky3.github.io/tags/aws/"/>
    
      <category term="restAPI" scheme="https://kisky3.github.io/tags/restAPI/"/>
    
  </entry>
  
  <entry>
    <title>Install AWS CLI On macOS</title>
    <link href="https://kisky3.github.io/2020/02/08/InstallAwsCLIOnMacOS/"/>
    <id>https://kisky3.github.io/2020/02/08/InstallAwsCLIOnMacOS/</id>
    <published>2020-02-08T11:54:37.000Z</published>
    <updated>2020-07-12T08:09:56.325Z</updated>
    
    <content type="html"><![CDATA[<p>在 macOS 上安装 AWS CLI 版本 1</p><a id="more"></a><p>1.先决条件<br>Python 2 版本 2.7+ 或 Python 3 版本 3.4+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python --version</span><br></pre></td></tr></table></figure><hr><p>2.使用捆绑安装程序安装 AWS CLI 版本 1<br>如果没有 unzip，请使用您喜欢的程序包管理器或等效工具进行安装。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;https://s3.amazonaws.com/aws-cli/awscli-bundle.zip&quot; -o &quot;awscli-bundle.zip&quot;</span><br><span class="line">unzip awscli-bundle.zip</span><br><span class="line">sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws</span><br></pre></td></tr></table></figure><hr><p>3.运行安装程序。该命令将 AWS CLI 安装到 /usr/local/aws，<br>并在 /usr/local/bin 目录中创建符号链接 aws。使用 -b 选项创建符号链接将免除在用户的 $PATH 变量中指定安装目录的需要。这应该能让所有用户在任何目录下通过键入 aws 来调用 AWS CLI。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./awscli-bundle/install -i /usr/local/aws -b /usr/local/bin/aws</span><br></pre></td></tr></table></figure><hr><p>4.查看是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws --version</span><br></pre></td></tr></table></figure><hr><p>参考<br><a href="https://docs.aws.amazon.com/zh_cn/cli/latest/userguide/install-macos.html#awscli-install-osx-pip" target="_blank" rel="noopener">AWS官方文档</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在 macOS 上安装 AWS CLI 版本 1&lt;/p&gt;
    
    </summary>
    
      <category term="Back-end Knowledge" scheme="https://kisky3.github.io/categories/Back-end-Knowledge/"/>
    
    
      <category term="awsCLI" scheme="https://kisky3.github.io/tags/awsCLI/"/>
    
      <category term="install" scheme="https://kisky3.github.io/tags/install/"/>
    
  </entry>
  
  <entry>
    <title>npm Error</title>
    <link href="https://kisky3.github.io/2020/02/08/npmError/"/>
    <id>https://kisky3.github.io/2020/02/08/npmError/</id>
    <published>2020-02-08T07:14:59.000Z</published>
    <updated>2020-07-12T08:09:56.697Z</updated>
    
    <content type="html"><![CDATA[<p> 常见npm错误</p><a id="more"></a><h3 id="npm-install-error"><a href="#npm-install-error" class="headerlink" title="npm install error"></a>npm install error</h3><p>在npm install时候发生error的话可以检查以下：</p><p><strong>1.是否存在package.json,因为npm安装的时候是根据package.json获取相应包的。没有源文件的话就无法获取资源。</strong></p><hr><p><strong>2.在有package.json的情况下有可能是重复多次安装npm，导致冲突。</strong><br>可以尝试以下步骤后再次安装。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 删除原先安装好的node_modules</span><br><span class="line">rm -rf node_modules</span><br><span class="line"></span><br><span class="line">// 清楚缓存</span><br><span class="line">npm cache clean --force</span><br><span class="line"></span><br><span class="line">// 更新npm</span><br><span class="line">npm update -g npm</span><br><span class="line"></span><br><span class="line">// 卸载npm</span><br><span class="line">npm uninstall npm -g</span><br></pre></td></tr></table></figure><hr><p><strong>3.当出现以下error的时候说明端口被占用,可以修改端口或者kill其他占用此端口的程序。</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; frontend@1.0.0 dev /Users/apple/Desktop/vue-s3-dropzone/frontend</span><br><span class="line">&gt; node build/dev-server.js</span><br><span class="line"></span><br><span class="line">events.js:174</span><br><span class="line">      throw er; // Unhandled &apos;error&apos; event</span><br><span class="line">      ^</span><br><span class="line"></span><br><span class="line">Error: listen EADDRINUSE: address already in use :::8080</span><br><span class="line">    at Server.setupListenHandle [as _listen2] (net.js:1279:14)</span><br><span class="line">    at listenInCluster (net.js:1327:12)</span><br><span class="line">    at Server.listen (net.js:1414:7)</span><br><span class="line">    at Function.listen (/Users/apple/Desktop/vue-s3-dropzone/frontend/node_modules/express/lib/application.js:617:24)</span><br><span class="line">    at Object.&lt;anonymous&gt; (/Users/apple/Desktop/vue-s3-dropzone/frontend/build/dev-server.js:60:22)</span><br><span class="line">    at Module._compile (internal/modules/cjs/loader.js:776:30)</span><br><span class="line">    at Object.Module._extensions..js (internal/modules/cjs/loader.js:787:10)</span><br><span class="line">    at Module.load (internal/modules/cjs/loader.js:653:32)</span><br><span class="line">    at tryModuleLoad (internal/modules/cjs/loader.js:593:12)</span><br><span class="line">    at Function.Module._load (internal/modules/cjs/loader.js:585:3)</span><br><span class="line">    at Function.Module.runMain (internal/modules/cjs/loader.js:829:12)</span><br><span class="line">    at startup (internal/bootstrap/node.js:283:19)</span><br><span class="line">    at bootstrapNodeJSCore (internal/bootstrap/node.js:622:3)</span><br><span class="line">Emitted &apos;error&apos; event at:</span><br><span class="line">    at emitErrorNT (net.js:1306:8)</span><br><span class="line">    at process._tickCallback (internal/process/next_tick.js:63:19)</span><br><span class="line">    at Function.Module.runMain (internal/modules/cjs/loader.js:832:11)</span><br><span class="line">    at startup (internal/bootstrap/node.js:283:19)</span><br><span class="line">    at bootstrapNodeJSCore (internal/bootstrap/node.js:622:3)</span><br><span class="line">npm ERR! code ELIFECYCLE</span><br><span class="line">npm ERR! errno 1</span><br><span class="line">npm ERR! frontend@1.0.0 dev: `node build/dev-server.js`</span><br><span class="line">npm ERR! Exit status 1</span><br><span class="line">npm ERR!</span><br><span class="line">npm ERR! Failed at the frontend@1.0.0 dev script.</span><br><span class="line">npm ERR! This is probably not a problem with npm. There is likely additional logging output above.</span><br><span class="line"></span><br><span class="line">npm ERR! A complete log of this run can be found in:</span><br><span class="line">npm ERR!     /Users/apple/.npm/_logs/2020-02-08T07_13_59_039Z-debug.log</span><br></pre></td></tr></table></figure><hr><p><strong>4.有可能在安装时候包丢失，可以修复一下</strong><br>Error:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">return (new fsevents(path)).on(&apos;fsevent&apos;, callback).start(); ^</span><br><span class="line"></span><br><span class="line">TypeError: fsevents is not a constructor at createFSEventsInstance (/Users/nannam/test-app-2/node_modules/chokidar/lib/fsevents-handler.js:28:11) at setFSEventsListener (/Users/nannam/test-app-2/node_modules/chokidar/lib/fsevents-handler.js:82:16) at FSWatcher.FsEventsHandler._watchWithFsEvents (/Users/nannam/test-app-2/node_modules/chokidar/lib/fsevents-handler.js:252:16) at FSWatcher. (/Users/nannam/test-app-2/node_modules/chokidar/lib/fsevents-handler.js:386:25) at LOOP (fs.js:1565:14) at process._tickCallback (internal/process/next_tick.js:61:11) error Command failed with exit code 1. info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.</span><br></pre></td></tr></table></figure><p>解决方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm audit fix --force</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt; 常见npm错误&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="npm" scheme="https://kisky3.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>Vue VeeValidation Sample</title>
    <link href="https://kisky3.github.io/2020/01/30/VeeValidation/"/>
    <id>https://kisky3.github.io/2020/01/30/VeeValidation/</id>
    <published>2020-01-30T08:57:50.000Z</published>
    <updated>2020-07-12T08:09:56.454Z</updated>
    
    <content type="html"><![CDATA[<p>Vue的表单验证组件 VeeValidation</p><a id="more"></a><h3 id="1-安装VeeValidation"><a href="#1-安装VeeValidation" class="headerlink" title="1. 安装VeeValidation"></a>1. 安装VeeValidation</h3><p>从npm安装VeeValidation<br>官网： <a href="https://logaretm.github.io/vee-validate/guide/basics.html" target="_blank" rel="noopener">VeeValidation</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install vee-validate --save</span><br></pre></td></tr></table></figure><hr><h3 id="2-VeeValidation进行验证"><a href="#2-VeeValidation进行验证" class="headerlink" title="2. VeeValidation进行验证"></a>2. VeeValidation进行验证</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; extend, ValidationProvider, ValidationObserver &#125; <span class="keyword">from</span> <span class="string">"vee-validate"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; required &#125; <span class="keyword">from</span> <span class="string">"vee-validate/dist/rules"</span>;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;section <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"columns is-mobile"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"field"</span>&gt;</span><br><span class="line">        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"label"</span>&gt;テキストフォーム&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">          &lt;div class="control"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;validation-provider v-slot="&#123; errors &#125;" rules="required" name="テキスト項目"&gt;</span></span><br><span class="line"><span class="regexp">             &lt;input v-model="textValue" class="input" type="text" placeholder="Text input" /</span>&gt;</span><br><span class="line">             &lt;p v-show=<span class="string">"errors.length"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"help is-danger"</span>&gt;</span><br><span class="line">               &#123;&#123; errors[<span class="number">0</span>] &#125;&#125;</span><br><span class="line">             &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">           &lt;/</span>validation-provider&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>section&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import Card from '~/</span>components/Card<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  name: '</span>HomePage<span class="string">',</span></span><br><span class="line"><span class="string">  data () &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">      textValue: '</span><span class="string">'</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>写出来是这样子:<br><img src="./1.png" style="width:300px"></p><hr><h3 id="3-所有的验证通过之前限制送信"><a href="#3-所有的验证通过之前限制送信" class="headerlink" title="3. 所有的验证通过之前限制送信"></a>3. 所有的验证通过之前限制送信</h3><p>实际的表单里有很多输入项目，对各个输入项进行验证的话，要使用<strong>ValidationObserver</strong>,还可以利用它使所有的验证通过之前，设定送信按钮无效。<br>pages/form.vue</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;section <span class="class"><span class="keyword">class</span></span>=<span class="string">"section"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"columns is-mobile"</span>&gt;</span><br><span class="line">      &lt;validation-observer v-slot=<span class="string">"&#123; invalid &#125;"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"field"</span>&gt;</span><br><span class="line">        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"label"</span>&gt;お名前&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">          &lt;div class="control"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;text-field-with-validation v-model="textValue" rules="required" fieldname="お名前" /</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"field"</span>&gt;</span><br><span class="line">        &lt;label <span class="class"><span class="keyword">class</span></span>=<span class="string">"label"</span>&gt;メールアドレス&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">          &lt;div class="control"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;text-field-with-validation v-model="emailValue" rules="required|email" fieldname="メールアドレス" /</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"field"</span>&gt;</span><br><span class="line">          &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"control"</span>&gt;</span><br><span class="line">            &lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"button is-link"</span> :disabled=<span class="string">"invalid"</span>&gt;送信する&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;p v-show="invalid" class="help is-danger"&gt;</span></span><br><span class="line"><span class="regexp">             全ての必須項目を入力すると「新規追加」ボタンが有効化されます。</span></span><br><span class="line"><span class="regexp">            &lt;/</span>p&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/validation-observer&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/section&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> TextFieldWithValidation <span class="keyword">from</span> <span class="string">'@/components/TextFieldWithValidation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'HomePage'</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    TextFieldWithValidation</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      textValue: <span class="string">''</span>,</span><br><span class="line">      emailValue: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>重要的point是：<br>在<strong><validation-observer v-slot="{ invalid }"></validation-observer></strong>和<strong></strong>之间的表单项目都在VeeValidation的监视下，<br>如果有没有通过验证的项目的话<strong>invalid</strong>为true,给提交按钮加上<strong>:disabled=”invalid”</strong>限制的话就可设置成无效状态了。</p><p>另外像邮件地址的表单的话，<strong>rules=”required|email”</strong>在这里就是加了两个规则<strong>required（必填验证）</strong>和<strong>email（邮件格式验证）</strong>，<br>像这样用<strong>|</strong>隔开的话就可以设定复数的规则。</p><hr><h3 id="送信时首先进行表单全体验证"><a href="#送信时首先进行表单全体验证" class="headerlink" title="送信时首先进行表单全体验证"></a>送信时首先进行表单全体验证</h3><p>在验证没有全通过的时候，想自行定义操作处理的话，使用<strong>this.$refs.observer.validate()</strong>来进行表单的再次验证。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;validation-observer ref=<span class="string">"observer"</span> v-slot=<span class="string">"&#123; invalid &#125;"</span> tag=<span class="string">"form"</span> @submit.prevent=<span class="string">"submit()"</span>&gt;</span><br><span class="line">      &lt;text-field-<span class="keyword">with</span>-validation rules=<span class="string">"required"</span> v-model=<span class="string">"first"</span> /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;text-field-<span class="keyword">with</span>-validation rules=<span class="string">"required"</span> v-model=<span class="string">"second"</span> /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button :disabled=<span class="string">"invalid"</span>&gt;Submit&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>validation-observer&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    async submit () &#123;</span></span><br><span class="line"><span class="regexp">      const isValid = await this.$refs.observer.validate();</span></span><br><span class="line"><span class="regexp">      if (!isValid) &#123;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/ バリデーションが通る前に送信ボタンがクリックされた場合の処理</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">       /</span><span class="regexp">/ バリデーションが通っている状態で送信ボタンがクリックされた場合の処理</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vue的表单验证组件 VeeValidation&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Vue" scheme="https://kisky3.github.io/tags/Vue/"/>
    
      <category term="Validation" scheme="https://kisky3.github.io/tags/Validation/"/>
    
      <category term="VeeValidation" scheme="https://kisky3.github.io/tags/VeeValidation/"/>
    
      <category term="ValidationObserver" scheme="https://kisky3.github.io/tags/ValidationObserver/"/>
    
      <category term="ValidationProvider" scheme="https://kisky3.github.io/tags/ValidationProvider/"/>
    
  </entry>
  
  <entry>
    <title>Setting Vuex Namespace</title>
    <link href="https://kisky3.github.io/2020/01/30/VueNameSpace/"/>
    <id>https://kisky3.github.io/2020/01/30/VueNameSpace/</id>
    <published>2020-01-30T07:23:41.000Z</published>
    <updated>2020-07-12T08:09:56.455Z</updated>
    
    <content type="html"><![CDATA[<p>Vuex命名空间的设定</p><a id="more"></a><p>Vuex 2.1开始Store的module划分就变得简单了，追加<strong>namespace:true</strong>就可以自动划分命名空间了。</p><p>追加了这个选项之后，<strong>state</strong>，<strong>getters</strong>，<strong>actions</strong>，<strong>mutations</strong>就会自动地被划分到和自己所属的module名（下面的例子里module名就是helloModule）同名的命名空间里。</p><p>modules/hello/index.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> helloModule = &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>, <span class="comment">// 追加</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    hello: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    <span class="comment">// 方法名</span></span><br><span class="line">    hello(state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.hello</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="comment">// 方法名</span></span><br><span class="line">    sayHello(context, payload) &#123;</span><br><span class="line">      api.sayHello()</span><br><span class="line">        .then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    <span class="comment">// 方法名</span></span><br><span class="line">    hello(state, payload) &#123;</span><br><span class="line">      state.hello = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>呼出的时候「mapState/mapActions参数传递命名空间」的形式也可以。<br>还可以使用明确指明命名空间的形式。</p><h3 id="引用方：使用参数传递命名空间"><a href="#引用方：使用参数传递命名空间" class="headerlink" title="引用方：使用参数传递命名空间"></a>引用方：使用参数传递命名空间</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapState(<span class="string">'helloModule'</span>, <span class="comment">// ← 参数传递命名空间</span></span><br><span class="line">    <span class="comment">// 在这里state并不是根state、而是被自动识别为helloModule/state的命名空间</span></span><br><span class="line">    &#123;  </span><br><span class="line">      hello: <span class="function"><span class="params">state</span> =&gt;</span> state.hello</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  ...mapActions(<span class="string">'helloModule'</span>, <span class="comment">//← 参数传递命名空间</span></span><br><span class="line">    <span class="comment">// this.sayHello() 是 this.$store.dispatch('helloModule/sayHello')的映射</span></span><br><span class="line">    [<span class="string">'sayHello'</span>]</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="明确指定命名空间"><a href="#明确指定命名空间" class="headerlink" title="明确指定命名空间"></a>明确指定命名空间</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapState(&#123;</span><br><span class="line">    hello: <span class="function"><span class="params">state</span> =&gt;</span> state.helloModule.hello <span class="comment">// 这个state是全局store。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  ...mapActions([</span><br><span class="line">    <span class="comment">// this.sayHello() 是this.$store.dispatch('helloModule/sayHello')的映射</span></span><br><span class="line">    <span class="string">'helloModule/sayHello'</span></span><br><span class="line">  ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vuex命名空间的设定&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Vue" scheme="https://kisky3.github.io/tags/Vue/"/>
    
      <category term="form" scheme="https://kisky3.github.io/tags/form/"/>
    
  </entry>
  
  <entry>
    <title>Connect iPhone to Mac localhost Server</title>
    <link href="https://kisky3.github.io/2020/01/25/MacIphoneLocalhost/"/>
    <id>https://kisky3.github.io/2020/01/25/MacIphoneLocalhost/</id>
    <published>2020-01-25T06:43:21.000Z</published>
    <updated>2020-07-12T08:09:56.330Z</updated>
    
    <content type="html"><![CDATA[<p>用iphone连接Mac的Localhost服务器</p><a id="more"></a><p>1.iphone用USB连接Mac</p><p>2.<strong>iphone和Mac连接同一个wifi</strong></p><p>3.Mac ： System Setting =&gt; Network 查看该网络下的ip地址比如192.168.100.xxx</p><p>4.iphone地址栏输入ip地址 + port号即可以预览localhost</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.100.xxx:8080</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用iphone连接Mac的Localhost服务器&lt;/p&gt;
    
    </summary>
    
      <category term="System Setting" scheme="https://kisky3.github.io/categories/System-Setting/"/>
    
    
      <category term="iPhone" scheme="https://kisky3.github.io/tags/iPhone/"/>
    
      <category term="Localhost" scheme="https://kisky3.github.io/tags/Localhost/"/>
    
  </entry>
  
  <entry>
    <title>Vue Form Component</title>
    <link href="https://kisky3.github.io/2020/01/14/form/"/>
    <id>https://kisky3.github.io/2020/01/14/form/</id>
    <published>2020-01-14T13:51:40.000Z</published>
    <updated>2020-07-12T08:09:56.651Z</updated>
    
    <content type="html"><![CDATA[<p>Vue.js 的表单要素组件化</p><a id="more"></a><h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>首先是 input 的组件化。<code>field</code>的值是通过<code>@input</code>来监听变化，并使用<code>$emit</code>的<code>&#39;input&#39;</code>来给父组件的 v-model 传值。<code>updateValue</code>通过参数 e，取得<code>event</code>，并进一步取得<code>target.value</code>,通过<code>emit</code>传值给父组件。</p><p>子组件 MyInput.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:type</span>=<span class="string">"type"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:value</span>=<span class="string">"value"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:placeholder</span>=<span class="string">"placeholder"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">input</span>=<span class="string">"updateValue"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"MyInput"</span>,</span></span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    value: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    type: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    name: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    placeholder: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">false</span> &#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    updateValue: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, e.target.value);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件 App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyInput</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"sampleForm.text"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">"サンプル"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"sample-input"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">MyInput</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Textarea"><a href="#Textarea" class="headerlink" title="Textarea"></a>Textarea</h3><p>子组件 MyTextarea.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">textarea</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:value</span>=<span class="string">"value"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:placeholder</span>=<span class="string">"placeholder"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:rows</span>=<span class="string">"rows"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:cols</span>=<span class="string">"cols"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">input</span>=<span class="string">"updateValue"</span></span></span><br><span class="line"><span class="tag">  &gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"MyTextarea"</span>,</span></span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    value: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    name: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    placeholder: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">false</span> &#125;,</span></span><br><span class="line"><span class="javascript">    rows: &#123; <span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">required</span>: <span class="literal">false</span> &#125;,</span></span><br><span class="line"><span class="javascript">    cols: &#123; <span class="attr">type</span>: <span class="built_in">Number</span>, <span class="attr">required</span>: <span class="literal">false</span> &#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    updateValue: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, e.target.value);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件 App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyTextarea</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"sampleForm.textarea"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">placeholder</span>=<span class="string">"サンプル"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"sample-textarea"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:rows</span>=<span class="string">"10"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:cols</span>=<span class="string">"50"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">MyTextarea</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Radio-Button"><a href="#Radio-Button" class="headerlink" title="Radio Button"></a>Radio Button</h3><p>子组件 MyRadio</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"(option, index) in options"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">"option.value"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">change</span>=<span class="string">"updateValue"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span>&#123;&#123; option.label &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"MyRadio"</span>,</span></span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    value: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    options: &#123; <span class="attr">type</span>: <span class="built_in">Array</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    name: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    updateValue: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, e.target.value);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件 App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 変数optionsには[&#123;label: "hoge", value: "1"&#125;, &#123;label: "fuga", value: "2"&#125;]のようなオブジェクトの配列を設定</span><br><span class="line"><span class="tag">&lt;<span class="name">MyRadio</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"sampleForm.radio"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"sample-radio"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">MyRadio</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h3><p>子组件 select.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">:name</span>=<span class="string">"name"</span> @<span class="attr">change</span>=<span class="string">"updateValue"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"(option, index) in options"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">:value</span>=<span class="string">"option.value"</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">          &#123;&#123; option.label &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"MySelect"</span>,</span></span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    value: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    options: &#123; <span class="attr">type</span>: <span class="built_in">Array</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    name: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    updateValue: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, e.target.value);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, <span class="keyword">this</span>.options[<span class="number">0</span>].value);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件 App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```App.vue</span><br><span class="line">// 変数optionsには[&#123;label: "hoge", value: "1"&#125;, &#123;label: "fuga", value: "2"&#125;]のようなオブジェクトの配列を設定</span><br><span class="line"><span class="tag">&lt;<span class="name">MySelect</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"sampleForm.select"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"sample-select"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">MySelect</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Checkbox"><a href="#Checkbox" class="headerlink" title="Checkbox"></a>Checkbox</h3><p>子组件 MyCheckbox.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"(option, index) in options"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">"checkbox"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:name</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">"option.value"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">change</span>=<span class="string">"updateValue"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span>&#123;&#123; option.label &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"MyCheckbox"</span>,</span></span><br><span class="line">  props: &#123;</span><br><span class="line"><span class="javascript">    options: &#123; <span class="attr">type</span>: <span class="built_in">Array</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line"><span class="javascript">    name: &#123; <span class="attr">type</span>: <span class="built_in">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span></span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      values: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    updateValue: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line">      if (e.target.checked) &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.values.push(e.target.value);</span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.values = <span class="keyword">this</span>.values.filter(<span class="function"><span class="params">v</span> =&gt;</span> v !== e.target.value);</span></span><br><span class="line">      &#125;</span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, <span class="keyword">this</span>.values);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>父组件 App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 変数optionsには[&#123;label: "hoge", value: "1"&#125;, &#123;label: "fuga", value: "2"&#125;]のようなオブジェクトの配列を設定</span><br><span class="line"><span class="tag">&lt;<span class="name">MyCheckbox</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"sampleForm.checkbox"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">"sample-checkbox"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">MyCheckbox</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Form全体"><a href="#Form全体" class="headerlink" title="Form全体"></a>Form全体</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyLabel</span>&gt;</span>InputText<span class="tag">&lt;/<span class="name">MyLabel</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyInput</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"sampleForm.text"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">"サンプル"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"sample-input"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">MyInput</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyLabel</span>&gt;</span>TextArea<span class="tag">&lt;/<span class="name">MyLabel</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyTextarea</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"sampleForm.textarea"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">"サンプル"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"sample-textarea"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:rows</span>=<span class="string">"10"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:cols</span>=<span class="string">"50"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">MyTextarea</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyLabel</span>&gt;</span>RadioButton<span class="tag">&lt;/<span class="name">MyLabel</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyRadio</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"sampleForm.radio"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"sample-radio"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">MyRadio</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyLabel</span>&gt;</span>Checkbox<span class="tag">&lt;/<span class="name">MyLabel</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyCheckbox</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"sampleForm.checkbox"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"sample-checkbox"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">MyCheckbox</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyLabel</span>&gt;</span>Select<span class="tag">&lt;/<span class="name">MyLabel</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MySelect</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"sampleForm.select"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"sample-select"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:options</span>=<span class="string">"options"</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">MySelect</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">MyBtn</span> @<span class="attr">click</span>=<span class="string">"sendForm"</span>&gt;</span>send<span class="tag">&lt;/<span class="name">MyBtn</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyInput <span class="keyword">from</span> <span class="string">"./components/MyInput"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyTextarea <span class="keyword">from</span> <span class="string">"./components/MyTextarea"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyRadio <span class="keyword">from</span> <span class="string">"./components/MyRadio"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyCheckbox <span class="keyword">from</span> <span class="string">"./components/MyCheckbox"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MySelect <span class="keyword">from</span> <span class="string">"./components/MySelect"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyBtn <span class="keyword">from</span> <span class="string">"./components/MyBtn"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> MyLabel <span class="keyword">from</span> <span class="string">"./components/MyLabel"</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"app"</span>,</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    MyTextarea,</span><br><span class="line">    MyInput,</span><br><span class="line">    MyRadio,</span><br><span class="line">    MyCheckbox,</span><br><span class="line">    MySelect,</span><br><span class="line">    MyBtn,</span><br><span class="line">    MyLabel</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      sampleForm: &#123;</span><br><span class="line"><span class="javascript">        text: <span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">        radio: <span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">        select: <span class="string">""</span>,</span></span><br><span class="line"><span class="javascript">        textarea: <span class="string">""</span>,</span></span><br><span class="line">        checkbox: []</span><br><span class="line">      &#125;,</span><br><span class="line">      options: [</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          label: <span class="string">"fizz"</span>,</span></span><br><span class="line"><span class="javascript">          value: <span class="string">"3"</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          label: <span class="string">"buzz"</span>,</span></span><br><span class="line"><span class="javascript">          value: <span class="string">"5"</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">          label: <span class="string">"fizzBuzz"</span>,</span></span><br><span class="line"><span class="javascript">          value: <span class="string">"15"</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    sendForm() &#123;</span><br><span class="line"><span class="javascript">      <span class="comment">// formデータの送信処理</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vue.js 的表单要素组件化&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="vue" scheme="https://kisky3.github.io/tags/vue/"/>
    
      <category term="form" scheme="https://kisky3.github.io/tags/form/"/>
    
  </entry>
  
  <entry>
    <title>Vue Image Update</title>
    <link href="https://kisky3.github.io/2020/01/07/VueImageUpdate/"/>
    <id>https://kisky3.github.io/2020/01/07/VueImageUpdate/</id>
    <published>2020-01-07T14:29:44.000Z</published>
    <updated>2020-07-12T08:09:56.454Z</updated>
    
    <content type="html"><![CDATA[<p>Vue的手机拍照相册照片上传<br>一个小demo<br>支持手机相册和拍照上传</p><a id="more"></a><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      id=<span class="string">"upload_file"</span></span><br><span class="line">      type=<span class="string">"file"</span></span><br><span class="line">      style=<span class="string">"display: none;"</span></span><br><span class="line">      accept=<span class="string">"image/*"</span></span><br><span class="line">      name=<span class="string">"file"</span></span><br><span class="line">      @change=<span class="string">"fileChange($event)"</span></span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload_warp"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload_warp_img"</span>&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload_warp_img_div"</span> v-<span class="keyword">for</span>=<span class="string">"(item, index) in imgList"</span>&gt;</span><br><span class="line">          &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload_warp_img_div_top"</span>&gt;</span><br><span class="line">            &lt;img</span><br><span class="line">              src=<span class="string">"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAkFBMVEX///8nJjYeHS8bGi0gHzAjIjMYFyvy8vMdGy4WFSnt7e7h4eMlJDXm5ujq6usXFirb2934+PlDQk9cW2ZNTFg+PUvT09YSECdpaHIAABxWVWBJSFRsa3VRUFwPDSXNzdA1NEMwLz+urrNhYGuLi5K+vcJ/f4eenqSqqq+Hh46YmJ56eYHEw8cAACEAABmrq7AxYxi+AAALtklEQVR4nN1d2WKiShQUUFFAxRXjSlziTOLM/P/fXdAYkaWKpYHm1qMapVLdp3o9p9W6Q198blar5edebzUc+v5zud1GmJynyqjd6bS7vdWvmp5MEM4rq3tjoq4Oz1eNzR/VUu5ovx3t+p6vKIzj7slkdzQfL0+7SgC9SWMpmtN+kEl3e6c4Pr687FGcL2p+0pwYTrqvTLT1rTN+hl5WFLWZFM1tL8zEOXmvGz0r/LpHsYENdbiNSKVY7x6RixN5vZEqmpOIgn5X/N0aL9WYNzyKJv9SmWCsogr6Is5b5rwT946iuvu6HzoLBq4WS0OxWvZ7tBve0HYbpKK5SiCoKK2FksDQo9iYvmhacX3wm2Gihg2KqPY6NpZ8MxxM4vvhnWIjVDRdQNBKiqUNomhPEMGJ54e75PebYBrxPvjAyBvU6EpyM/UoriXvizZqokrnZgixg5onxcmgbhIIJgoyirI73T71BSlKPdOwO5Bg73j/mJFslzcV59KqCG3CmzzNHk+uh2eIof+ErFNiEyuobZ/SDI9YxYmUEZUpOA22PX3VPBWh0Xvzpunw5ePDJaQooWkskNF7okzD66L6mlCUrKGamGA/pKAPA6soWUPd4ybaW41j/siYYRVlsv7FHCu4in9WnfRFeax/77TRk2rTOAV9DBti/fs5JBiOokEQ61cnUqi4IAoe0e7S8Bi7YvWkKEFEJQpqUwP+uT4lKtYeURcKbqJHTJBaf+2msXchwajRR6Fj0+jV21AX2AfjjD4KYyNvuNnjJhpv9FHIa/0LHGSSjD4KWa2fGf0ynYI+hlsZrR/bhNVfZjllYeD5Yi0qEqPvbtIr6GMwlW3WTxTsZlLQh7GVy/qvHRxkNtkPApEBXK/aKfEZrltnCjJP6OGTDSGKswrDzRUTdHIo6MPAKmqzylQ89yBBdZn3iw2sojpjg1xBuL5jBTMHmSfIfFGrJtyc/+A+uCny5QNi/ZMKVDy7iGBGo4+CzBe1WekqXrGCWY0+Cmb9ZUfUM+yDVjdnFA1Cx9ZfckS94iiax+ijGB5H6Ed6ZVJkRl+4id6hTwjF0hoqMfqdEAV9GEtIsbRwQ4y+9yXupwysorouxTSI0e++xDTRO+qwfmb0H2J/js36xVv/gQzVhCrog1m/6C3U81vieTsfI8EK+mDWvxYaUQ+JRyZv6ApX0AfZ6xdq/QcHN9GPMgj6C/5VWf+hAxXUBNrEK/R1NdZ/6GCbKElBH8T6e2LCzaEPFRRp9FEYa7I8lWZjhOCAh2p/SgkyT4TuSEUoFrf+A7YJ0UYfxWCNDqx61l9QRWIT4o0+CiPm8k1QxWJ9kShYhtFHMYheoHqlWCCiMqMvMYoGQcJN8NBjRhz62CZOImkgkAFcLy/Ff21sE5UR9FRMumX0UDFXuPnXhgq+VUjQG8Bh09C2OQZwlx1UUK2UoEdxThpq5hWUC26i1Srog1h/N+vm2+WvNH3wAWb92dZuLng2UV0UDSLh1uaPiln64gUavTWqhaCn4gqrmN40LioeydREMIX1p1QRR1GrniZ6x4DMNNJRvGjSBZknjHnxARwhWL1NvIKc2EixPCWZ0UcxxCrSvX7pjD4KY4q3bbD1Y6O3ep9V0UAYzMhSMVARG721k4Kgb/1k8y1RRaKgdqmSBsKA3NOYJUymTrAPSkTQP1WMVYz3xU9i9BIRzGf9J/hfsdpSEaTWH7Ow8TmCCv6VjKA/68cLG+Fwc0KJDhSrIx1Br6G+45nGq/WfYnI3BQi+SUiQboS/7PWf3qCCsvXBB8jF1cBe/wl+ULIoGsQQj25++iJRUJM4saE5I7dzbyqeYIe1etIq6GMwgSrebneSKOpITRCmpPKhTQcNM/oohu+QYhvfzbL+StwHHyDDcAv6oNIAgr71Q4qI4Nu/uh8+Hcil92SC1oF/uRwg1p9E0GlEE71jMIMzjVh01MYo6INYf5yCaoMU9DHE1h8l6DRKQR/E+sMElYZE0SCGeK//leBb4xT0Qay/6Qr6SMwL+/9Q0McQ7xL/KNhYgums33Ia2kTvIGs3PsF2gxX0Ya7gOScPDSfYan3hdtoRe4mheoy/WCtVU+cjkRMfPJhqq4puhJcBHefy+Ua3wSpu0jl+71jNyV/h0Jdw2TCAdNmd5MMSbr68qpiYBlBi6Bt8Tiak4rFxKo5T9sEHcCpACTHewAzaMRjRXHlSQd90MzTRh4oNojjeZF9q8zMeNqahekafWUEfo8aYRsYg84TWDOtPb/RRNMP6l2SHFyeCkN/6PaNHDFT3gPf6pbf+8RLvj7p7ng1f6ohq4PQZbcVPtzjAF4p4mtwaYeCTX+35vQyYjbdtWKrjGqHjGhJt55EwkxwQk3aMSm7sPRT0EVOpMAiUcrxGjEkTdYKV6kyiooymMcR5QdqhnK4k1V1/JZ2KY3zLq62Eaw3auLpB2qzOlWFIUrnHlOEbrLGKcvVFfYoVjK0WSaw/TXb1ykBuzN6NPgpm/fL4IjP6SVK9T2Ia0li/ThJIdZIvPg3emzBGJUaP6yiRvlg0N6kQjHGQUTs41QkuDWdpuTMEC4NJ0n7Ta/mkvJ9T90zDIJfyXZ6sBpdo/CnwVxNMPGFPV+0Dl9kslOm5MAZ4opc2Mz0slZo337oQmCRbZOqi0KQKnphUujlgzkhijPQJo4hpZK97IAQDQtDKktzEtAjFGhoqCTJqxsy7ZO2mv6zcNAwSZKysOc1sqGL11m/jI8B5il+Y2Fortn6D3MNLYfRR2KQaV5XWb+PpuZYzyye1/spUZEafO1OrPSFl/yqKqCSKagVKepkuUrFwoYe0T4F9UFsVybVLTKMS62dbR26xJTJs/VYF1k+KuGqFT+Ex6y/bNExC0C1+zNBWYF8sOdyQOsOakLV40tFLtX4Te7KoYmw2vklb4mFN0ge7SWloMoNZf1kqkr2U/EYf81Nk1l/OFipTsGgS6BeY8+qtn9qE2Ho69oxU/RVOkTTRokYfhdnF1i+oStAPWBOdij9uv8B9UfDyFDH6kdA++MCih5tNoYJyIRCj75d0OoRE1J24cEOMPmdu6xRYvGPrF7V2s8dNtF/iJh+Jb4JqdpFa31oJQSbw43gAJ6TuGuuD2RN3Z4KNd4kFRFRSjn5U+nFQbBrF6x8uCMF1+asKNjaNgtZ/JQQrWd8jKhYao9o4Wo/KKZkXQXnWf1VwKezK9ryI9efeJbYxQTFLFulQjvVf8beWNVSLhw3ni/nqcpMo2q341gCz/uzrqHuiYOXnsURbPzH6/lf153iY9WcLN6Rn92s5hm2ruN9ksX4WZL7qOf1hr9FjZbF+qmBdh5SIiqn3+s/4e6qo7ZYEW8hS8V7F1dqrP/cRAPGwVHv9Z1wh0xG9ipcRZNafYgBHan13N3UfvWYr08z6zxZWsL5jgj8gh1KI9Z9ZpWgJjl2TARxeDb8SBSW5b7VwsPUn15o94z5Yl9FHscfD8EQ/25MoKsflhxv2WMWEms8H7IN1Gn0UOKJau7i+yIy+rpPICdjjBYhedO2GGX0lVWqzgCzF78JNjhj96EMuBX3gKawVWoFjCpZa6zsvFgoewAVVJDbh/JYpyDxBTCNg/WeNDLbrpIFArf+bIhuLSqqgD7IC9z0RMvCMvu7pEsaij1W8WcAXvF7n/K6bBAaxfr+YhOminE4jqUYyccALu531sHVBEspn9FHghY3+pTUF78to9FFA6+/MWi5QUEqjj2IBF/xbgKDENvEKaP3JDOU1+ijsUTLF1jwhlDqnpijoY5F826a1jG/DTYiiQSy6SRRb59iMCI4kRVzTI2mp+L01mMSMSruNCTJPxFu/uvGrRkcVlKCQcnbEzfotax+X/6jbqCDzRIz13ydQ5volYay1k3ywnYxFJ0SxrdwPTprTAEVV/dVMBX1cX8PNM3uTftKcXseyOm3tbXuu9RkLwnadn8DZcYLpqYzLZuK689XHtb6nEwL90+3eamG3R+4ptBM4MG2zCVMJBvPXca4o7vHX9xWX/wCc1c1uhrLWkwAAAABJRU5ErkJggg=="</span></span><br><span class="line">              <span class="class"><span class="keyword">class</span></span>=<span class="string">"upload_warp_img_div_del"</span></span><br><span class="line">              @click=<span class="string">"fileDel(index)"</span></span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">          &lt;img :src="item.file.src" style="display: inline-block;" /</span>&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div</span></span><br><span class="line"><span class="regexp">          class="upload_warp_left"</span></span><br><span class="line"><span class="regexp">          id="upload_warp_left"</span></span><br><span class="line"><span class="regexp">          @click="fileClick()"</span></span><br><span class="line"><span class="regexp">          v-if="this.imgList.length &lt; 6"</span></span><br><span class="line"><span class="regexp">        &gt;</span></span><br><span class="line"><span class="regexp">          &lt;!--&lt;img src="../</span>assets/upload.png<span class="string">"&gt;--&gt;</span></span><br><span class="line"><span class="string">          &lt;div&gt;相册上传&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div class="</span>upload_warp_text<span class="string">"&gt;</span></span><br><span class="line"><span class="string">      &lt;span</span></span><br><span class="line"><span class="string">        &gt;选中&#123;&#123; imgList.length &#125;&#125;张文件，共&#123;&#123; bytesToSize(this.size) &#125;&#125;&lt;/span</span></span><br><span class="line"><span class="string">      &gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string">&lt;script type="</span>text/ecmascript<span class="number">-6</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">  export default &#123;</span></span><br><span class="line"><span class="string">    name: "</span>cameras-and-albums<span class="string">",</span></span><br><span class="line"><span class="string">   data()&#123;</span></span><br><span class="line"><span class="string">    return&#123;</span></span><br><span class="line"><span class="string">     imgList: [],</span></span><br><span class="line"><span class="string">     datas: new FormData(),</span></span><br><span class="line"><span class="string">     files:0,</span></span><br><span class="line"><span class="string">     size:0</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">   &#125;,</span></span><br><span class="line"><span class="string">   methods:&#123;</span></span><br><span class="line"><span class="string">    //调用相册&amp;相机</span></span><br><span class="line"><span class="string">    fileClick() &#123;</span></span><br><span class="line"><span class="string">     $('#upload_file').click();</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    //调用手机摄像头并拍照</span></span><br><span class="line"><span class="string">    getImage() &#123;</span></span><br><span class="line"><span class="string">     let cmr = plus.camera.getCamera();</span></span><br><span class="line"><span class="string">     cmr.captureImage(function(p) &#123;</span></span><br><span class="line"><span class="string">      plus.io.resolveLocalFileSystemURL(p, function(entry) &#123;</span></span><br><span class="line"><span class="string">       compressImage(entry.toLocalURL(),entry.name);</span></span><br><span class="line"><span class="string">      &#125;, function(e) &#123;</span></span><br><span class="line"><span class="string">       plus.nativeUI.toast("</span>读取拍照文件错误：<span class="string">" + e.message);</span></span><br><span class="line"><span class="string">      &#125;);</span></span><br><span class="line"><span class="string">     &#125;, function(e) &#123;</span></span><br><span class="line"><span class="string">     &#125;, &#123;</span></span><br><span class="line"><span class="string">      filter: 'image'</span></span><br><span class="line"><span class="string">     &#125;);</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    //从相册选择照片</span></span><br><span class="line"><span class="string">    galleryImgs() &#123;</span></span><br><span class="line"><span class="string">     plus.gallery.pick(function(e) &#123;</span></span><br><span class="line"><span class="string">      let name = e.substr(e.lastIndexOf('/') + 1);</span></span><br><span class="line"><span class="string">      compressImage(e,name);</span></span><br><span class="line"><span class="string">     &#125;, function(e) &#123;</span></span><br><span class="line"><span class="string">     &#125;, &#123;</span></span><br><span class="line"><span class="string">      filter: "</span>image<span class="string">"</span></span><br><span class="line"><span class="string">     &#125;);</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    //点击事件，弹出选择摄像头和相册的选项</span></span><br><span class="line"><span class="string">    showActionSheet() &#123;</span></span><br><span class="line"><span class="string">     let bts = [&#123;</span></span><br><span class="line"><span class="string">      title: "</span>拍照<span class="string">"</span></span><br><span class="line"><span class="string">     &#125;, &#123;</span></span><br><span class="line"><span class="string">      title: "</span>从相册选择<span class="string">"</span></span><br><span class="line"><span class="string">     &#125;];</span></span><br><span class="line"><span class="string">     plus.nativeUI.actionSheet(&#123;</span></span><br><span class="line"><span class="string">       cancel: "</span>取消<span class="string">",</span></span><br><span class="line"><span class="string">       buttons: bts</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      function(e) &#123;</span></span><br><span class="line"><span class="string">       if (e.index == 1) &#123;</span></span><br><span class="line"><span class="string">        this.getImage();</span></span><br><span class="line"><span class="string">       &#125; else if (e.index == 2) &#123;</span></span><br><span class="line"><span class="string">        this.galleryImgs();</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">     );</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    fileChange(el) &#123;</span></span><br><span class="line">     this.files=$("#upload_file").get(0).files;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span>.files.length);</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="keyword">this</span>.files.length;i++)&#123;</span><br><span class="line">      <span class="keyword">this</span>.datas.append(<span class="string">"file"</span>,<span class="keyword">this</span>.files[i]);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">this</span>.show1=<span class="literal">false</span>;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="keyword">this</span>.files);</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span>.files);</span><br><span class="line">     <span class="keyword">if</span> (!el.target.files[<span class="number">0</span>].size) <span class="keyword">return</span>;</span><br><span class="line">     <span class="keyword">this</span>.fileList(el.target);</span><br><span class="line">     el.target.value = <span class="string">''</span></span><br><span class="line">    &#125;,</span><br><span class="line">    fileList(fileList) &#123;</span><br><span class="line">     <span class="keyword">let</span> files = fileList.files;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; files.length; i++) &#123;</span><br><span class="line">      <span class="comment">//判断是否为文件夹</span></span><br><span class="line">      <span class="keyword">if</span> (files[i].type != <span class="string">''</span>) &#123;</span><br><span class="line">       <span class="keyword">this</span>.fileAdd(files[i]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">//文件夹处理</span></span><br><span class="line">       <span class="keyword">this</span>.folders(fileList.items[i]);</span><br><span class="line">      &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//文件夹处理</span></span><br><span class="line">    folders(files) &#123;</span><br><span class="line">     <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line">     <span class="comment">//判断是否为原生file</span></span><br><span class="line">     <span class="keyword">if</span> (files.kind) &#123;</span><br><span class="line">      files = files.webkitGetAsEntry();</span><br><span class="line">     &#125;</span><br><span class="line">     files.createReader().readEntries(<span class="function"><span class="keyword">function</span> (<span class="params">file</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; file.length; i++) &#123;</span><br><span class="line">       <span class="keyword">if</span> (file[i].isFile) &#123;</span><br><span class="line">        _this.foldersAdd(file[i]);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _this.folders(file[i]);</span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">     &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    fileAdd(file) &#123;</span><br><span class="line">     <span class="comment">//总大小</span></span><br><span class="line">     <span class="keyword">this</span>.size = <span class="keyword">this</span>.size + file.size;</span><br><span class="line">     <span class="comment">//判断是否为图片文件</span></span><br><span class="line">     <span class="keyword">if</span> (file.type.indexOf(<span class="string">'image'</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">      file.src = <span class="string">'wenjian.png'</span>;</span><br><span class="line">      <span class="keyword">this</span>.imgList.push(&#123;</span><br><span class="line">       file</span><br><span class="line">      &#125;);</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">      reader.vue = <span class="keyword">this</span>;</span><br><span class="line">      reader.readAsDataURL(file);</span><br><span class="line">      reader.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       file.src = <span class="keyword">this</span>.result;</span><br><span class="line">       <span class="keyword">this</span>.vue.imgList.push(&#123;</span><br><span class="line">        file</span><br><span class="line">       &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    fileDel(index) &#123;</span><br><span class="line">     <span class="keyword">this</span>.size = <span class="keyword">this</span>.size - <span class="keyword">this</span>.imgList[index].file.size;<span class="comment">//总大小</span></span><br><span class="line">     <span class="keyword">this</span>.imgList.splice(index, <span class="number">1</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    bytesToSize(bytes) &#123;</span><br><span class="line">     <span class="keyword">if</span> (bytes === <span class="number">0</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'0 B'</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">let</span> k = <span class="number">1000</span>, <span class="comment">// or 1024</span></span><br><span class="line">      sizes = [<span class="string">'B'</span>, <span class="string">'KB'</span>, <span class="string">'MB'</span>, <span class="string">'GB'</span>, <span class="string">'TB'</span>, <span class="string">'PB'</span>, <span class="string">'EB'</span>, <span class="string">'ZB'</span>, <span class="string">'YB'</span>],</span><br><span class="line">      i = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.log(bytes) / <span class="built_in">Math</span>.log(k));</span><br><span class="line">     <span class="keyword">return</span> (bytes / <span class="built_in">Math</span>.pow(k, i)).toPrecision(<span class="number">3</span>) + <span class="string">' '</span> + sizes[i];</span><br><span class="line">    &#125;,</span><br><span class="line">    dragenter(el) &#123;</span><br><span class="line">     el.stopPropagation();</span><br><span class="line">     el.preventDefault();</span><br><span class="line">    &#125;,</span><br><span class="line">    dragover(el) &#123;</span><br><span class="line">     el.stopPropagation();</span><br><span class="line">     el.preventDefault();</span><br><span class="line">    &#125;,</span><br><span class="line">    drop(el) &#123;</span><br><span class="line">     el.stopPropagation();</span><br><span class="line">     el.preventDefault();</span><br><span class="line">     <span class="keyword">this</span>.fileList(el.dataTransfer);</span><br><span class="line">    &#125;,</span><br><span class="line">    shows(et,tx)&#123;</span><br><span class="line">     <span class="keyword">this</span>.strut=et;</span><br><span class="line">     <span class="keyword">this</span>.txt=tx;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleClick()&#123;</span><br><span class="line">     <span class="keyword">this</span>.$store.commit(<span class="string">'add'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;style lang=""&gt;</span></span><br><span class="line"><span class="regexp">    .upload_warp_img_div_del &#123;</span></span><br><span class="line"><span class="regexp">    position: absolute;</span></span><br><span class="line"><span class="regexp">    top: 6px;</span></span><br><span class="line"><span class="regexp">    width: 16px;</span></span><br><span class="line"><span class="regexp">    right: 4px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_img_div_top &#123;</span></span><br><span class="line"><span class="regexp">    position: absolute;</span></span><br><span class="line"><span class="regexp">    top: 0;</span></span><br><span class="line"><span class="regexp">    width: 100%;</span></span><br><span class="line"><span class="regexp">    height: 30px;</span></span><br><span class="line"><span class="regexp">    background-color: rgba(0, 0, 0, 0.4);</span></span><br><span class="line"><span class="regexp">    line-height: 30px;</span></span><br><span class="line"><span class="regexp">    text-align: left;</span></span><br><span class="line"><span class="regexp">    color: #fff;</span></span><br><span class="line"><span class="regexp">    font-size: 12px;</span></span><br><span class="line"><span class="regexp">    text-indent: 4px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_img_div_text &#123;</span></span><br><span class="line"><span class="regexp">    white-space: nowrap;</span></span><br><span class="line"><span class="regexp">    width: 80%;</span></span><br><span class="line"><span class="regexp">    overflow: hidden;</span></span><br><span class="line"><span class="regexp">    text-overflow: ellipsis;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_img_div img &#123;</span></span><br><span class="line"><span class="regexp">    max-width: 100%;</span></span><br><span class="line"><span class="regexp">    max-height: 100%;</span></span><br><span class="line"><span class="regexp">    vertical-align: middle;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_img_div &#123;</span></span><br><span class="line"><span class="regexp">    position: relative;</span></span><br><span class="line"><span class="regexp">    height: 100px;</span></span><br><span class="line"><span class="regexp">    width: 120px;</span></span><br><span class="line"><span class="regexp">    border: 1px solid #ccc;</span></span><br><span class="line"><span class="regexp">    margin: 0px 5px 5px 0px;</span></span><br><span class="line"><span class="regexp">    float: left;</span></span><br><span class="line"><span class="regexp">    line-height: 100px;</span></span><br><span class="line"><span class="regexp">    display: table-cell;</span></span><br><span class="line"><span class="regexp">    text-align: center;</span></span><br><span class="line"><span class="regexp">    background-color: #eee;</span></span><br><span class="line"><span class="regexp">    cursor: pointer;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_img &#123;</span></span><br><span class="line"><span class="regexp">    border-top: 1px solid #D2D2D2;</span></span><br><span class="line"><span class="regexp">    padding: 5px 0 0 5px;</span></span><br><span class="line"><span class="regexp">    overflow: hidden</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_text &#123;</span></span><br><span class="line"><span class="regexp">    text-align: left;</span></span><br><span class="line"><span class="regexp">    margin-bottom: 5px;</span></span><br><span class="line"><span class="regexp">    padding-top: 5px;</span></span><br><span class="line"><span class="regexp">    text-indent: 14px;</span></span><br><span class="line"><span class="regexp">    border-top: 1px solid #ccc;</span></span><br><span class="line"><span class="regexp">    font-size: 14px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_right &#123;</span></span><br><span class="line"><span class="regexp">    float: left;</span></span><br><span class="line"><span class="regexp">    width: 57%;</span></span><br><span class="line"><span class="regexp">    margin-left: 2%;</span></span><br><span class="line"><span class="regexp">    height: 100%;</span></span><br><span class="line"><span class="regexp">    border: 1px dashed #999;</span></span><br><span class="line"><span class="regexp">    border-radius: 4px;</span></span><br><span class="line"><span class="regexp">    line-height: 130px;</span></span><br><span class="line"><span class="regexp">    color: #999;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_left button &#123;</span></span><br><span class="line"><span class="regexp">    margin: 8px 5px 0px 5px;</span></span><br><span class="line"><span class="regexp">    cursor:pointer;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp_left &#123;</span></span><br><span class="line"><span class="regexp">    float: left;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.upload_warp &#123;</span></span><br><span class="line"><span class="regexp">    margin: 5px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Vue的手机拍照相册照片上传&lt;br&gt;一个小demo&lt;br&gt;支持手机相册和拍照上传&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="vue" scheme="https://kisky3.github.io/tags/vue/"/>
    
      <category term="image upload" scheme="https://kisky3.github.io/tags/image-upload/"/>
    
  </entry>
  
  <entry>
    <title>Easy Slack bot from Google Apps Script</title>
    <link href="https://kisky3.github.io/2019/12/25/SlackBot/"/>
    <id>https://kisky3.github.io/2019/12/25/SlackBot/</id>
    <published>2019-12-25T14:50:23.000Z</published>
    <updated>2020-07-12T08:09:56.413Z</updated>
    
    <content type="html"><![CDATA[<p>如何利用GAS做一个简单的机器人</p><a id="more"></a><p>如何利用GAS(Google Apps Script)来做一个可以定时提醒的bot呢.<br>首先功能是这样，每天早上（除了周末和节假日）的8:59分和下午17:59的时候，会自动发消息圈到当天应该做值日的人，并提醒他做值日。<br><img src="./1.png" style="width: 400px"></p><hr><h3 id="创建频道"><a href="#创建频道" class="headerlink" title="创建频道"></a>创建频道</h3><p>在slack上创建一个用于发送和管理消息的频道。名字和说明任意即可。<br>如果要往已存在的频道发送消息则可以忽略这一步。<br><img src="./2.png" style="width: 400px"></p><hr><h3 id="制作Bot"><a href="#制作Bot" class="headerlink" title="制作Bot"></a>制作Bot</h3><p>点击<a href="https://api.slack.com/start/overview" target="_blank" rel="noopener">https://api.slack.com/start/overview</a>,　然后在跳转页面点击「Create a Slack App」</p><p>输入你的bot名字和workplace,然后点击「Create App」。<br><img src="./3.png" style="width: 400px"></p><hr><h3 id="设置Incoming-Webhooks"><a href="#设置Incoming-Webhooks" class="headerlink" title="设置Incoming Webhooks"></a>设置Incoming Webhooks</h3><p>在bot设定的左侧介面点击features&gt;Incoming Webhooks、将「Activate Incoming Webhooks」 设置为On。<br>然后在页面下部会出现「Add New Webhook to WorkSpace 」的选项，点击并许可。<br><img src="./4.png" style="width: 400px"><br><img src="./5.png" style="width: 400px"></p><p>在页面的下方会显示「Webhook URL」，记得要将它复制下来。<br>之后GAS里的Script代码需要用它来进行连接并取得你在GAS里创建的数据。</p><hr><h3 id="制作保存数据的GAS"><a href="#制作保存数据的GAS" class="headerlink" title="制作保存数据的GAS"></a>制作保存数据的GAS</h3><p>这里需要三列，一是用于显示的值日生名字，一个是对应值日日期，第三列是slack上该用户的对应用户名（这里建议用用户ID，因为当用户名中间有空格时，有时不能很好地圈到slack用户）<br><img src="./6.png" style="width: 400px"></p><hr><h3 id="制作GAS的script"><a href="#制作GAS的script" class="headerlink" title="制作GAS的script"></a>制作GAS的script</h3><p>从菜单点击「ツール」「スクリプトエディタ」，然后在里面输入你的script代码。<br><img src="./7.png" style="width: 400px"><br><img src="./8.png" style="width: 400px"></p><p>这次使用的代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set timer 08:59</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTrigger08</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> triggerDay = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  triggerDay.setHours(<span class="number">08</span>);</span><br><span class="line">  triggerDay.setMinutes(<span class="number">59</span>);</span><br><span class="line">  ScriptApp.newTrigger(<span class="string">"main"</span>).timeBased().at(triggerDay).create();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set timer 17:59</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTrigger17</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> triggerDay = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  triggerDay.setHours(<span class="number">17</span>);</span><br><span class="line">  triggerDay.setMinutes(<span class="number">59</span>);</span><br><span class="line">  ScriptApp.newTrigger(<span class="string">"main"</span>).timeBased().at(triggerDay).create();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// delete Trigger</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteTrigger</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> triggers = ScriptApp.getProjectTriggers();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; triggers.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (triggers[i].getHandlerFunction() == <span class="string">"main"</span>) &#123;</span><br><span class="line">      ScriptApp.deleteTrigger(triggers[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main method</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  deleteTrigger();</span><br><span class="line">  core_function();</span><br><span class="line">  Logger.log(<span class="string">'main'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">core_function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get script sheet URL</span></span><br><span class="line">    <span class="keyword">var</span> spreadSheet = SpreadsheetApp.openByUrl(<span class="string">'https://docs.google.com/spreadsheets/xxxxxx'</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get the first sheet</span></span><br><span class="line">    <span class="keyword">var</span> sheet = spreadSheet.getSheets()[<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get Rows</span></span><br><span class="line">    <span class="keyword">var</span> lastrow = sheet.getLastRow();</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get current date</span></span><br><span class="line">    <span class="keyword">var</span> currentDay = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// To determine if a current date is a workday or not</span></span><br><span class="line">　　<span class="function"><span class="keyword">function</span> <span class="title">isWeekDay</span>(<span class="params">currentDate</span>) </span>&#123;</span><br><span class="line">  　　<span class="keyword">var</span> weekday = currentDate.getDay();</span><br><span class="line">  　　<span class="keyword">if</span> (weekday == <span class="number">0</span> || weekday == <span class="number">6</span>) &#123;</span><br><span class="line">    　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  　　&#125;</span><br><span class="line">  　　<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// To determine if a current date is a holiday or not</span></span><br><span class="line">　　<span class="function"><span class="keyword">function</span> <span class="title">isEventsForDay</span>(<span class="params">currentDate</span>) </span>&#123;</span><br><span class="line">  　　<span class="keyword">var</span> calendar = CalendarApp.getCalendarById(<span class="string">'ja.japanese#holiday@group.v.calendar.google.com'</span>);</span><br><span class="line">  　　<span class="keyword">if</span> (calendar.getEventsForDay(currentDate, &#123;<span class="attr">max</span>: <span class="number">1</span>&#125;).length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    　　<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  　　&#125;</span><br><span class="line">  　　<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">　　&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get name ,date and metion name array</span></span><br><span class="line">    <span class="keyword">var</span> name_array = sheet.getSheetValues(<span class="number">2</span>, <span class="number">1</span>, lastrow, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> date_array = sheet.getSheetValues(<span class="number">2</span>, <span class="number">2</span>, lastrow, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> mention_array = sheet.getSheetValues(<span class="number">2</span>, <span class="number">3</span>, lastrow, <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Set date format for today</span></span><br><span class="line">    <span class="keyword">var</span> today = Utilities.formatDate(<span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="string">"Asia/Tokyo"</span>, <span class="string">"yyyy/MM/dd"</span>);</span><br><span class="line">    <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Roop to get date_number</span></span><br><span class="line">    <span class="keyword">var</span> date_num = date_array.length;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; date_num - <span class="number">1</span>; i++) &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Set date format for date</span></span><br><span class="line">        date.push(Utilities.formatDate(<span class="keyword">new</span> <span class="built_in">Date</span>(date_array[i]), <span class="string">"Asia/Tokyo"</span>, <span class="string">"yyyy/MM/dd"</span>));</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// Get index if today = date</span></span><br><span class="line">        <span class="keyword">var</span> num = date.indexOf(today);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Get name through index we got</span></span><br><span class="line">    <span class="keyword">var</span> member = name_array[num];</span><br><span class="line">    <span class="keyword">var</span> mention = mention_array[num];</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// if it is workday and not holiday then set message</span></span><br><span class="line">    <span class="keyword">var</span> message;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(member &amp;&amp; isWeekDay(currentDay) &amp;&amp; !isEventsForDay(currentDay)) &#123;</span><br><span class="line"> </span><br><span class="line">        message = <span class="string">'Hey〜！:sunny:\n 今日の当番は　*'</span> + member + <span class="string">'* です！ &lt;@'</span> + mention + <span class="string">'&gt;: \n 本日「加湿器ON/OFF」、「終礼」、「ゴミ捨て」をあなたに任せるよ ！！ \n ※都合が悪い時にみんなに言ってくださいね'</span>;</span><br><span class="line">       </span><br><span class="line">       <span class="comment">// Send message to slack</span></span><br><span class="line">       Logger.log(message);</span><br><span class="line">       postSlack(message)</span><br><span class="line">    &#125; </span><br><span class="line"> </span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">postSlack</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Webhook URL you copied when you created a app</span></span><br><span class="line">    <span class="keyword">var</span> url = <span class="string">"https://hooks.slack.com/xxxxxxxx"</span>;</span><br><span class="line">    <span class="keyword">var</span> options = &#123;</span><br><span class="line">      <span class="string">"method"</span> : <span class="string">"POST"</span>,</span><br><span class="line">      <span class="string">"headers"</span>: &#123;<span class="string">"Content-type"</span>: <span class="string">"application/json"</span>&#125;,</span><br><span class="line">      <span class="string">"payload"</span> : <span class="string">'&#123;"text":"'</span> + message + <span class="string">'"&#125;'</span></span><br><span class="line">    &#125;;</span><br><span class="line">     <span class="comment">// Run here</span></span><br><span class="line">     UrlFetchApp.fetch(url, options);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="将GAS-Script设置为公开Application"><a href="#将GAS-Script设置为公开Application" class="headerlink" title="将GAS　Script设置为公开Application"></a>将GAS　Script设置为公开Application</h3><p>从菜单的「公開」点击「ウェブアプリケーションとして導入」<br><img src="./9.png" style="width: 400px"></p><img src="./10.png" style="width: 400px"><p>点击更新按钮后Web　Application的URL就会被更新，然后同样将它copy下来。</p><hr><h3 id="设置SlackApi的Outgoing-Webhooks"><a href="#设置SlackApi的Outgoing-Webhooks" class="headerlink" title="设置SlackApi的Outgoing Webhooks"></a>设置SlackApi的Outgoing Webhooks</h3><p>连接下面的URL</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://(your workplace name).slack.com/apps/manage</span><br></pre></td></tr></table></figure><p>OutgoingWebhooks为关键词搜索，并点击出现的Popup,跳转之后点击设定。<br><img src="./11.png" style="width: 400px"></p><p>在Outgoing Webhooks的Integration Settings里设定你的频道名，并将刚刚复制的GAS的URL粘贴并保存。<br><img src="./12.png" style="width: 400px"></p><hr><h3 id="Slack里发送消息的设定"><a href="#Slack里发送消息的设定" class="headerlink" title="Slack里发送消息的设定"></a>Slack里发送消息的设定</h3><p>在GAS的编辑页面，点击菜单「編集」「現在のプロジェクトのトリガー」。</p><p>在GAS管理页面打开后点击右下的「トリガーを追加」。<br><img src="./15.png" style="width: 400px"><br><img src="./14.png" style="width: 400px"></p><p>完成！</p><hr><h3 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h3><h5 id="1-GAS只能在一个小时内进行执行，如何尽量准确地指定时间呢。可以在scirpt里写入下面的代码："><a href="#1-GAS只能在一个小时内进行执行，如何尽量准确地指定时间呢。可以在scirpt里写入下面的代码：" class="headerlink" title="1.GAS只能在一个小时内进行执行，如何尽量准确地指定时间呢。可以在scirpt里写入下面的代码："></a>1.GAS只能在一个小时内进行执行，如何尽量准确地指定时间呢。可以在scirpt里写入下面的代码：</h5><p>然后トリガー的执行时间设定选择为08~09点，这样就可以在08:59的准确时间进行Slack的消息发送了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set timer 08:59</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTrigger08</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> triggerDay = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  triggerDay.setHours(<span class="number">08</span>);</span><br><span class="line">  triggerDay.setMinutes(<span class="number">59</span>);</span><br><span class="line">  ScriptApp.newTrigger(<span class="string">"main"</span>).timeBased().at(triggerDay).create();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考：<br><a href="https://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a" target="_blank" rel="noopener">Google Apps Scriptの日毎のトリガーで時間をもっと細かく設定する</a></p><hr><h5 id="2-在Slack想圈出用户时，如果用户名中间有空格则会失效"><a href="#2-在Slack想圈出用户时，如果用户名中间有空格则会失效" class="headerlink" title="2.在Slack想圈出用户时，如果用户名中间有空格则会失效"></a>2.在Slack想圈出用户时，如果用户名中间有空格则会失效</h5><p>这时不使用&lt;@username&gt;而是使用&lt;@userID&gt;，就可以解决这个问题了。<br>类似这样的<br><img src="./16.png" style="width: 400px"></p><p>参考：<br><a href="https://qiita.com/tomoeine/items/ee7bae955efec9db1a96" target="_blank" rel="noopener">Slack APIでユーザー宛のメンションができなくなったので対策した</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;如何利用GAS做一个简单的机器人&lt;/p&gt;
    
    </summary>
    
      <category term="System Setting" scheme="https://kisky3.github.io/categories/System-Setting/"/>
    
    
      <category term="setting" scheme="https://kisky3.github.io/tags/setting/"/>
    
      <category term="slack bot" scheme="https://kisky3.github.io/tags/slack-bot/"/>
    
      <category term="slack" scheme="https://kisky3.github.io/tags/slack/"/>
    
      <category term="Google Apps Script" scheme="https://kisky3.github.io/tags/Google-Apps-Script/"/>
    
  </entry>
  
  <entry>
    <title>Create a Git Commit Template</title>
    <link href="https://kisky3.github.io/2019/12/21/GitCommitTemplate/"/>
    <id>https://kisky3.github.io/2019/12/21/GitCommitTemplate/</id>
    <published>2019-12-21T14:27:00.000Z</published>
    <updated>2020-07-12T08:09:56.316Z</updated>
    
    <content type="html"><![CDATA[<p>创建Git Commit的Template</p><a id="more"></a><p>我们可以在commit的时候进行commit内容的统一。</p><h3 id="生成commit-message-template"><a href="#生成commit-message-template" class="headerlink" title="生成commit message template"></a>生成commit message template</h3><p>commit message template 本身可以指定路径并且让Git读取，可以在任意路径进行。</p><p>今天我们在my-cheatsheet的project的根目录进行配置。<br>并且设定只针对这个project有效。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 任意的文件名都可以</span><br><span class="line">$ vi .gitmessage</span><br></pre></td></tr></table></figure><p>然后可以自行设置commit内容，包括颜文字</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[branchname]</span><br><span class="line"># ==== Emojis ====</span><br><span class="line"># ✏️  :pencil2: Writing docs</span><br><span class="line"># 🐛  :bug: Fix bugs</span><br><span class="line"># 👍  :+1: Feature improvements</span><br><span class="line"># ✨  :sparkles: Additional partial feature</span><br><span class="line"># 🎉  :tada: Grand major features added to celebrate</span><br><span class="line"># ♻️  :recycle :Refactoring</span><br><span class="line"># 🚿  :shower: Removal of obsolete functions or features.</span><br><span class="line"># 💚  :green_heart: Modification and improvement of testing and CI</span><br><span class="line"># 👕  :shirt: Fixing of errors found by Lint.</span><br><span class="line"># 🚀  :rocket: Performance improvement</span><br><span class="line"># 🆙  :up: Updates, such as dependent package</span><br><span class="line"># 🔒  :lock: Limit of the range of new features</span><br><span class="line"># 👮  :cop: Security-related improvements</span><br><span class="line"># ==== Format ====</span><br><span class="line"># :emoji: Subject #issue No.</span><br><span class="line">#</span><br><span class="line"># Commit body...</span><br><span class="line"># ==== The Seven Rules ====</span><br><span class="line"># 1. Separate subject from body with a blank line</span><br><span class="line"># 2. Limit the subject line to 50 characters</span><br><span class="line"># 3. Capitalize the subject line</span><br><span class="line"># 4. Do not end the subject line with a period</span><br><span class="line"># 5. Use the imperative mood in the subject line</span><br><span class="line"># 6. Wrap the body at 72 characters</span><br><span class="line"># 7. Use the body to explain what and why vs. how</span><br></pre></td></tr></table></figure><hr><h3 id="注册你的commit-message-template"><a href="#注册你的commit-message-template" class="headerlink" title="注册你的commit message template"></a>注册你的commit message template</h3><p>在git config里注册你生成的Template。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config commit.template .gitmessage</span><br></pre></td></tr></table></figure><p>如果你想电脑里存在所有Git管理的项目都使用这个Template的话。要加上global option。<br>这个例子没有加option，说明只是针对当前的项目使用这个Template。</p><hr><h3 id="使用Template"><a href="#使用Template" class="headerlink" title="使用Template"></a>使用Template</h3><p>设置完成后在你commit的时候Template就会自动显示了，在commit的时候输入相应的emoji的编码就可以显示了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:bug: correct a bug</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git commit</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[branchname]</span><br><span class="line"># ==== Emojis ====</span><br><span class="line"># ✏️  :pencil2: Writing docs</span><br><span class="line"># 🐛  :bug: Fix bugs</span><br><span class="line"># 👍  :+1: Feature improvements</span><br><span class="line">//　省略</span><br></pre></td></tr></table></figure><p>以上！！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;创建Git Commit的Template&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Git" scheme="https://kisky3.github.io/tags/Git/"/>
    
      <category term="Template" scheme="https://kisky3.github.io/tags/Template/"/>
    
  </entry>
  
  <entry>
    <title>node.js Error:Listen EADDRINUSE</title>
    <link href="https://kisky3.github.io/2019/12/21/EADDRINUSE/"/>
    <id>https://kisky3.github.io/2019/12/21/EADDRINUSE/</id>
    <published>2019-12-21T14:07:45.000Z</published>
    <updated>2020-07-12T08:09:56.020Z</updated>
    
    <content type="html"><![CDATA[<p>node.js启动错误: Error: listen EADDRINUSE</p><a id="more"></a><p>在启动node app.js的时候出现了下面的错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">events.js:72</span><br><span class="line">        throw er; // Unhandled &apos;error&apos; event</span><br><span class="line">              ^</span><br><span class="line">Error: listen EADDRINUSE</span><br><span class="line">    at errnoException (net.js:904:11)</span><br><span class="line">    at Server._listen2 (net.js:1042:14)</span><br><span class="line">    at listen (net.js:1064:10)</span><br><span class="line">    at Server.listen (net.js:1138:5)</span><br><span class="line">    at Function.app.listen (/vagrant/girly/girly-batch/node_modules/express/lib/application.js:532:24)</span><br><span class="line">    at Object.&lt;anonymous&gt; (/vagrant/girly/girly-batch/bin/www:7:18)</span><br><span class="line">    at Module._compile (module.js:456:26)</span><br><span class="line">    at Object.Module._extensions..js (module.js:474:10)</span><br><span class="line">    at Module.load (module.js:356:32)</span><br><span class="line">    at Function.Module._load (module.js:312:12)</span><br></pre></td></tr></table></figure><p>原因是因为端口号被占用了。关闭占用该端口号的进程然后再次启动就好。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ps aux | grep node</span><br><span class="line">vagrant  14761  0.0  2.0 704016 38520 pts/0    Sl+  01:22   0:01 node app.js</span><br><span class="line">vagrant  15069  0.0  0.0 107456   908 pts/2    S+   01:59   0:00 grep --color=auto node</span><br><span class="line"></span><br><span class="line">$ sudo kill -9 14761</span><br><span class="line">$ node app.js</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;node.js启动错误: Error: listen EADDRINUSE&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="node.js" scheme="https://kisky3.github.io/tags/node-js/"/>
    
  </entry>
  
  <entry>
    <title>Connecting to GitHub with SSH</title>
    <link href="https://kisky3.github.io/2019/12/21/AboutGithubssh/"/>
    <id>https://kisky3.github.io/2019/12/21/AboutGithubssh/</id>
    <published>2019-12-21T08:40:36.000Z</published>
    <updated>2020-07-12T08:09:55.968Z</updated>
    
    <content type="html"><![CDATA[<p>利用ssh连接Github</p><a id="more"></a><p>虽然已经用ssh连接Github好几次了，但是一直以来对公钥和密钥的加密过程不清不楚，所以在这里总结以下</p><h3 id="什么是公钥和私钥"><a href="#什么是公钥和私钥" class="headerlink" title="什么是公钥和私钥"></a>什么是公钥和私钥</h3><p>公钥（Public Key）与私钥（Private Key）是通过一种算法得到的一个密钥对。<br>公钥是密钥对中公开的部分。</p><p>公钥加密法的步骤如下：</p><ol><li>首先接受方生成一对密钥，即私钥和公钥。</li><li>然后接收方将公钥法送给发送方。</li><li>发送方用收到的公钥对数据加密,再发送给接收方。</li><li>接收方收到数据后，使用自己的私钥解密。</li></ol><p>由于再非对称算法中，公钥加密的数据必须使用对应的私钥才能解密，而私钥又只有接受方自己知道，<br>这样就保证了数据传输的安全性。</p><hr><h3 id="公钥和密钥的生成"><a href="#公钥和密钥的生成" class="headerlink" title="公钥和密钥的生成"></a>公钥和密钥的生成</h3><p>连接Github的时候，需要再本地生成公钥和密钥，密钥自己保存而公钥需要发送给Github。</p><p>首先移动到保存钥的文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$cd ~/.ssh</span><br></pre></td></tr></table></figure><p>第一次生成钥匙的时候这个文件夹里应该是空的啥都没有。<br>不管有没有先生成钥,也可以自行加上option，但是一般情况下这样就可以了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>一般来说不用在意问题，连续三次按下回车键就可以看到生成了id_rsa(私钥)和id_rsa.pub(公钥)公钥对。<br>如果你已经生成过私钥(id_rsa)的话在这里会被覆盖。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/Users/(username)/.ssh/id_rsa):</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br></pre></td></tr></table></figure><img src="./1.png" style="width: 500px"><br>当你想修改钥名的时候，在第一个问题里输入你想要生成的钥名。比如在这里就指定了id_git_rsa,然后持续按下回车键就可以生成id_git_rsa和id_git_rsa.pub两个公钥对了。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/Users/(username)/.ssh/id_rsa):id_git_rsa</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br></pre></td></tr></table></figure><hr><h3 id="将公钥上传到Github"><a href="#将公钥上传到Github" class="headerlink" title="将公钥上传到Github"></a>将公钥上传到Github</h3><p>点击下面的网页进行公钥的设置：（前提是你已经拥有了自己的Github账号）<br><a href="https://github.com/settings/ssh" target="_blank" rel="noopener">https://github.com/settings/ssh</a></p><p>在画面上点击「Add SSH key」,然后在title的地方输入公钥名（任意），「key」里输入你生成公钥的内容。</p><img src="./2.png" style="width: 500px"><p>利用下面的命令行进行公钥内容的copy</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pbcopy &lt; ~/.ssh/id_rsa.pub (Mac)</span><br><span class="line">$ clip &lt; ~/.ssh/id_rsa.pub (Windows)</span><br></pre></td></tr></table></figure><ul><li>钥名为你自己生成的钥名，默认为id_rsa.pub</li></ul><hr><h3 id="确认连接"><a href="#确认连接" class="headerlink" title="确认连接"></a>确认连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>如果返回以下的文字则说明已经连接成功了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi (account名)! You&apos;ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure><p>但是注意如果生成钥的时候你指定了自己的钥名，有可能会连接不成功。<br>这是因为ssh连接的时候自动默认参照的是「<del>/.ssh/id_rsa」、「</del>/.ssh/id_dsa」、「<del>/.ssh/identity」的钥名文件。<br>你需要自己在</del>/.ssh/config中进行定义。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Host github github.com</span><br><span class="line">  HostName github.com</span><br><span class="line">  IdentityFile ~/.ssh/id_git_rsa # 在这里写下自己设置的私匙文件名</span><br><span class="line">  User git</span><br></pre></td></tr></table></figure><p>然后再连接一次应该就能连接上了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T github</span><br></pre></td></tr></table></figure><hr><h3 id="与GitHub的互动"><a href="#与GitHub的互动" class="headerlink" title="与GitHub的互动"></a>与GitHub的互动</h3><p>实际上在与Github互动的时候,比如pull或push的时候还需要确认用户名和密码，那就说明SSH并没有很好地运作。<br>在~/.gitconfig文件里进行设定后就可以解决了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[url &quot;github:&quot;]</span><br><span class="line">    InsteadOf = https://github.com/</span><br><span class="line">    InsteadOf = git@github.com:</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;利用ssh连接Github&lt;/p&gt;
    
    </summary>
    
      <category term="Front-end Knowledge" scheme="https://kisky3.github.io/categories/Front-end-Knowledge/"/>
    
    
      <category term="Git" scheme="https://kisky3.github.io/tags/Git/"/>
    
      <category term="SSH" scheme="https://kisky3.github.io/tags/SSH/"/>
    
  </entry>
  
  <entry>
    <title>The Basic Annals of Xiang Yu</title>
    <link href="https://kisky3.github.io/2019/12/14/XiangyuBenJi/"/>
    <id>https://kisky3.github.io/2019/12/14/XiangyuBenJi/</id>
    <published>2019-12-14T14:06:37.000Z</published>
    <updated>2020-07-12T08:09:56.455Z</updated>
    
    <content type="html"><![CDATA[<p>史记・项羽本纪</p><a id="more"></a><p>前两天刷了项羽本纪（顺带把相关纪录片和秦始皇本纪也看完了）</p><p>乱世出英雄，令我惊奇的是2000多年前的他，透过文字依然能给我传达了很鲜明的个人特色和画面感。<br>有如神助末路英雄的设定真的是完爆一切网络爽文。</p><p>巨鹿之战，在所有诸侯作壁上观之时，孤立无援，还受到怀王排挤之时，项羽能够当机立断一举斩杀宋义，在节骨眼夺回兵权。<br>然后破釜沉舟再一举灭了大秦。他的对手是章邯和王离啊，两个都是顶级的战神大佬，可惜项羽是灭霸一样的存在。</p><p>5万零散的楚军敌王离和章邯的40万大军，一战成名，从那天起巨鹿之战也成为了以少胜多的名战争的代表。<br>灭秦之后，各诸侯见他都是犹如见神，一路跪着前行参拜。几乎一己之力灭掉了第一强国大秦的项羽，在彼时人们眼中毫无疑问就是神一般的存在。而那时他才24岁啊。</p><p>之后的彭城之战也是以少胜多，仅仅3万人马，日夜兼程赶回，连夜进攻，半天就将刘邦的56万汉军打得溃不成军。这一战更是奠定了他灭霸的地位。</p><img src="./1.jpg" style="width: 500px"><p>个人觉得项羽有一种贵族出生的少年气，意气风发,雷厉风行，喜欢光明磊落少一点城府和厚重感。</p><p>他不计较樊哙的鲁莽，反而赏赐酒肉，大度地微笑着欣赏他。<br>他担忧战乱频繁生灵涂炭，三番两次请战刘邦要求单独决斗。<br>他在四面楚歌之时的绝望，作出垓下之歌表达对跟随自己多年的美人和名驹的不舍。<br>他在说出天要亡我决定放弃一切决死一战之际，还把名驹赠与了乌江亭长。<br>在他最后下马步战，单人斩杀汉军三百余骑之后，还亲手斩下自己的头颅赠与了旧相识用于换赏。</p><p>这样的一代枭雄，最后连个全尸都没留下来。<br>胜者为王败者为寇，后世写的史书还有刻意抹黑项羽的成分。（比如硬说阿房宫是他烧的，还说他挖了秦始皇的陵墓）</p><p>想想甚是难过。</p><p>最后跑个题，发现古人的名字都好有意味<br>项羽，刘邦，宋义，熊心，樊哙，项庄，萧何，韩信，章邯，王翦，王离，虞姬，蒙恬，赢政，李斯等等…<br>简单又大气，喜欢!</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;史记・项羽本纪&lt;/p&gt;
    
    </summary>
    
      <category term="About Me" scheme="https://kisky3.github.io/categories/About-Me/"/>
    
    
      <category term="Xiang Yu" scheme="https://kisky3.github.io/tags/Xiang-Yu/"/>
    
      <category term="Hegemon-King of Western Chu" scheme="https://kisky3.github.io/tags/Hegemon-King-of-Western-Chu/"/>
    
      <category term="Xiang Ji" scheme="https://kisky3.github.io/tags/Xiang-Ji/"/>
    
      <category term="Records of the Grand Historian" scheme="https://kisky3.github.io/tags/Records-of-the-Grand-Historian/"/>
    
  </entry>
  
</feed>
